"use strict";function CVcardModel(){this.uid=ko.observable(""),this.file=ko.observable(""),this.name=ko.observable(""),this.email=ko.observable(""),this.exists=ko.observable(!1),this.isJustSaved=ko.observable(!1)}var _=require("underscore"),ko=require("knockout"),TextUtils=require("%PathToCoreWebclientModule%/js/utils/Text.js"),Types=require("%PathToCoreWebclientModule%/js/utils/Types.js"),Api=require("%PathToCoreWebclientModule%/js/Api.js"),App=require("%PathToCoreWebclientModule%/js/App.js"),Ajax=require("modules/%ModuleName%/js/Ajax.js"),ContactsCache=require("modules/%ModuleName%/js/Cache.js"),HeaderItemView=App.isNewTab()?null:require("modules/%ModuleName%/js/views/HeaderItemView.js"),MainTab=App.isNewTab()&&window.opener?window.opener.MainTabContactsMethods:null;CVcardModel.prototype.parse=function(e){e&&"Object/Aurora\\Modules\\Mail\\Classes\\Vcard"===e["@Object"]&&(this.uid(Types.pString(e.Uid)),this.file(Types.pString(e.File)),this.name(Types.pString(e.Name)),this.email(Types.pString(e.Email)),this.exists(!!e.Exists),ContactsCache.addVcard(this))},CVcardModel.prototype.onContactsSaveVcfResponse=function(e,s){e.Result?this.uid(e.Result.Uid):(Api.showErrorByCode(e,TextUtils.i18n("%MODULENAME%/ERROR_CREATE_CONTACT")),this.exists(!1))},CVcardModel.prototype.addContact=function(){Ajax.send("AddContactsFromFile",{File:this.file()},this.onContactsSaveVcfResponse,this),this.isJustSaved(!0),this.exists(!0),setTimeout(_.bind(function(){this.isJustSaved(!1)},this),2e4),HeaderItemView?HeaderItemView.recivedAnim(!0):MainTab&&MainTab.markVcardsExistentByFile(this.file())},module.exports=CVcardModel;