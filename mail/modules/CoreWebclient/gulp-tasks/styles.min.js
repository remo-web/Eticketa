function BuildLibsCss(){var s=[sPathToCoreWebclient+"/styles/vendors/normalize.css",sPathToCoreWebclient+"/styles/vendors/jquery/jquery-ui-1.10.4.custom.min.css",sPathToCoreWebclient+"/styles/vendors/inputosaurus.css"];CheckFolderAndCallHandler("static/styles/libs/",function(){gulp.src(s).pipe(concat("libs.css")).pipe(gulp.dest("static/styles/libs/")).on("error",log)})}function BuildThemeCss(s,e){var t=e?"CoreMobileWebclient":"CoreWebclient",l=[],n=[],i=[],o=e?"-mobile":"",a=aModulesNames.indexOf(t);fs.existsSync("modules/"+t+"/styles/themes/"+s+"/styles"+o+".less")&&(a>=0&&aModulesNames.unshift(aModulesNames.splice(a,1)[0]),aModulesNames.forEach(function(s){fs.existsSync("modules/"+s+"/styles/styles"+o+".less")&&(fs.existsSync("tenants/"+sTenanthash+"/modules/"+s+"/styles/styles"+o+".less")?l.push("tenants/"+sTenanthash+"/modules/"+s+"/styles/styles"+o+".less"):l.push("modules/"+s+"/styles/styles"+o+".less")),s!==t&&fs.existsSync("modules/"+s+"/styles/images")&&MoveFiles("modules/"+s+"/styles/images","static/styles/images/modules/"+s)}),l.forEach(function(e){var t=e.replace("styles"+o+".less","themes/"+s+"/styles"+o+".less");fs.existsSync(t)&&n.push(t)}),l.forEach(function(s){var e=s.replace("styles"+o+".less","themes/_default"+o+".less");fs.existsSync(e)&&i.push(e)}),l=i.concat(n.concat(l)),gulp.src(l).pipe(concat("styles"+o+".css",{process:function(s,e){return'@import "'+e+'";\r\n'}})).pipe(plumber({errorHandler:function(s){console.log(s.toString()),this.emit("end")}})).pipe(less()).pipe(gulp.dest(sTenantPathPrefix+"static/styles/themes/"+s)).on("error",log))}function CheckFolderAndCallHandler(s,e){fs.existsSync(s)?e():mkdirp(s,function(t){fs.existsSync(s)?e():console.log(s+" directory creating was failed: ",t)})}function MoveFiles(s,e){var t=function(s){return console.log(s),!0};fs.existsSync(s)&&CheckFolderAndCallHandler(e,function(){ncp(s,e,t,function(e){e&&console.log(s+" directory copying was failed: ",e)})})}function MoveSharingCss(){CheckFolderAndCallHandler("static/styles",function(){ncp(sPathToCoreWebclient+"/styles/sharing.css","static/styles/sharing.css",function(s){s&&console.log("static/styles/sharing.css file copying was failed: ",s)})})}var _=require("underscore"),argv=require("./argv.js"),gulp=require("gulp"),less=require("gulp-less"),log=require("fancy-log"),concat=require("gulp-concat-util"),plumber=require("gulp-plumber"),fs=require("fs"),ncp=require("ncp").ncp,mkdirp=require("mkdirp"),aModulesNames=argv.getModules(),aModulesWatchPaths=[],aThemes=argv.getParameter("--themes").split(","),sTenanthash=argv.getParameter("--tenant"),sTenantPathPrefix=sTenanthash?"tenants/"+sTenanthash+"/":"",sPathToCoreWebclient="modules/CoreWebclient",sPathToCoreMobileWebclient="modules/CoreMobileWebclient";aModulesNames.forEach(function(s){(fs.existsSync("./modules/"+s+"/styles/styles.less")||fs.existsSync("./modules/"+s+"/styles/styles-mobile.less"))&&aModulesWatchPaths.push("./modules/"+s+"/styles/**/*.less")}),gulp.task("styles",function(s){sTenanthash||BuildLibsCss(),MoveFiles(sPathToCoreWebclient+"/styles/vendors/jquery/images","static/styles/libs/images"),MoveFiles(sPathToCoreWebclient+"/styles/fonts",sTenantPathPrefix+"static/styles/fonts"),MoveFiles(sPathToCoreWebclient+"/styles/images",sTenantPathPrefix+"static/styles/images"),MoveSharingCss(),_.each(aThemes,function(s){BuildThemeCss(s,!1),BuildThemeCss(s,!0),MoveFiles(sPathToCoreWebclient+"/styles/themes/"+s,sTenantPathPrefix+"static/styles/themes/"+s),MoveFiles(sPathToCoreMobileWebclient+"/styles/themes/"+s+"/images-mobile",sTenantPathPrefix+"static/styles/themes/"+s+"/images-mobile")}),s()}),gulp.task("cssonly",function(s){_.each(aThemes,function(s){BuildThemeCss(s,!1),BuildThemeCss(s,!0)}),s()}),gulp.task("styles:watch",gulp.series("styles",function(s){gulp.watch(aModulesWatchPaths,{interval:500},function(s){_.each(aThemes,function(s){BuildThemeCss(s,!1),BuildThemeCss(s,!0)}),s()}),s()})),module.exports={};