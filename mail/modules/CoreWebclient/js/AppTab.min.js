function CAppTab(){this.tabs=ModulesManager.getModulesTabs(!0),this.focused=ko.observable(!0),ko.computed(function(){var e="";App.isNewTab()||this.focused()||(e=this.getInactiveTitle()),""===e&&(e=Screens.browserTitle()),this.setTitle(e)},this),this.favico=!Browser.ie8AndBelow&&CFavico?new CFavico({animation:"none"}):null}var _=require("underscore"),$=require("jquery"),ko=require("knockout"),App=require("%PathToCoreWebclientModule%/js/App.js"),Browser=require("%PathToCoreWebclientModule%/js/Browser.js"),CFavico=require("%PathToCoreWebclientModule%/js/vendors/favico.js"),ModulesManager=require("%PathToCoreWebclientModule%/js/ModulesManager.js"),Screens=require("%PathToCoreWebclientModule%/js/Screens.js"),UserSettings=require("%PathToCoreWebclientModule%/js/Settings.js");CAppTab.prototype.init=function(){Browser.ie?$(document).bind("focusin",_.bind(this.focused,this,!0)).bind("focusout",_.bind(this.focused,this,!1)):$(window).bind("focus",_.bind(this.focused,this,!0)).bind("blur",_.bind(this.focused,this,!1)),this.favico&&ko.computed(function(){var e=0;_.each(this.tabs,function(t){t.allowChangeTitle()&&(e+=t.unseenCount())}),this.favico.badge(e<100?e:"99+")},this)},CAppTab.prototype.setTitle=function(e){""===e?e=UserSettings.SiteName:e+=""!==UserSettings.SiteName?" - "+UserSettings.SiteName:"",document.title=".",document.title=e},CAppTab.prototype.getInactiveTitle=function(){var e="",t=0;return _.each(this.tabs,function(i){i.allowChangeTitle()&&(t+=i.unseenCount(),e=i.unseenCount()>0&&t===i.unseenCount()?i.inactiveTitle():"")}),t>0&&""===e&&(e=t+" new"),e};var AppTab=new CAppTab;AppTab.init(),module.exports={focused:AppTab.focused};