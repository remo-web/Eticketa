"use strict";var _=require("underscore"),UserSettings=require("%PathToCoreWebclientModule%/js/Settings.js"),AppData=window.auroraAppData,oModules={};module.exports={init:function(e){_.each(e,function(e,t){if(_.isFunction(e)){var s=e(AppData);s&&(oModules[t]=s)}}),_.each(oModules,_.bind(function(e){_.isFunction(e.start)&&e.start(this)},this))},getModulesScreens:function(){var e={};return _.each(oModules,function(t,s){_.isFunction(t.getScreens)&&(e[s]=t.getScreens())}),e},getModulesTabs:function(e){return _.isArray(this.aTabs)||(this.aTabs=[],this.aStandardTabs=[],_.each(oModules,_.bind(function(e,t){if(_.isFunction(e.getHeaderItem)){var s=e.getHeaderItem();s&&s.item&&(_.isFunction(s.item.setName)&&(s.item.setName(s.name||t),this.aStandardTabs.push(s.item)),this.aTabs.push(s.item),oModules[t]&&oModules[t].enableModule&&(s.item.visible(oModules[t].enableModule()),oModules[t].enableModule.subscribe(function(e){s.item.visible(e)})))}},this)),this.aStandardTabs=_.sortBy(this.aStandardTabs,function(e){var t=_.indexOf(UserSettings.HeaderModulesOrder,e.sName);return-1!==t?t:UserSettings.HeaderModulesOrder.length}),this.aTabs=_.sortBy(this.aTabs,function(e){var t=_.indexOf(UserSettings.HeaderModulesOrder,e.sName);return-1!==t?t:UserSettings.HeaderModulesOrder.length})),e?this.aStandardTabs:this.aTabs},getModulesPrefetchers:function(){var e=[];return _.each(oModules,function(t,s){_.isFunction(t.getPrefetcher)&&e.push(t.getPrefetcher())}),e},isModuleIncluded:function(e){return void 0!==oModules[e]},isModuleEnabled:function(e){return oModules[e]&&(!oModules[e].enableModule||oModules[e].enableModule())},isModuleAvailable:function(e){return-1!==window.aAvailableBackendModules.indexOf(e)||-1!==window.aAvailableModules.indexOf(e)},run:function(e,t,s){if(this.isModuleEnabled(e)){var n=oModules[e];if(n&&_.isFunction(n[t]))return _.isArray(s)||(s=[]),n[t].apply(n,s)}return!1}};