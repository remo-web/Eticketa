"use strict";function CPopups(){this.popups=[],this.$popupsPlace=$("#auroraContent .popups")}var _=require("underscore"),$=require("jquery"),ko=require("knockout"),Types=require("%PathToCoreWebclientModule%/js/utils/Types.js");CPopups.prototype.hasOpenedMinimizedPopups=function(){var p=!1;return _.each(this.popups,function(e){e.minimized&&e.minimized()&&(p=!0)}),p},CPopups.prototype.hasOnlyOneOpenedPopup=function(){return 1===this.popups.length},CPopups.prototype.hasOpenedMaximizedPopups=function(){var p=!1;return _.each(this.popups,function(e){e.minimized&&e.minimized()||(p=!0)}),p},CPopups.prototype.hasUnsavedChanges=function(){var p=!1;return _.each(this.popups,function(e){!p&&e&&_.isFunction(e.hasUnsavedChanges)&&e.hasUnsavedChanges()&&(p=!0,_.isFunction(e.minimized)&&e.minimized()&&_.isFunction(e.maximize)&&e.maximize())}),p},CPopups.prototype.showPopup=function(p,e){if(p){if(!p.$popupDom&&Types.isNonEmptyString(p.PopupTemplate)){var o=$("\x3c!-- ko template: { name: '"+p.PopupTemplate+"' } --\x3e\x3c!-- /ko --\x3e").appendTo(this.$popupsPlace);ko.applyBindings(p,o[0]),p.$popupDom=o.next(),p.$templatePlace=o,p.onBind()}_.isFunction(p.openPopup)&&p.openPopup(e)}},CPopups.prototype.addPopup=function(p){this.popups.push(p),1===this.popups.length&&(this.keyupPopupBound=_.bind(this.keyupPopup,this),$(document).on("keyup",this.keyupPopupBound))},CPopups.prototype.keyupPopup=function(p){var e=this.popups.length>0?this.popups[this.popups.length-1]:null;if(p&&e&&(!e.minimized||!e.minimized())){var o=Types.pInt(p.keyCode);Enums.Key.Esc===o&&e.onEscHandler(p),Enums.Key.Enter!==o&&Enums.Key.Space!==o||e.onEnterHandler()}},CPopups.prototype.removePopup=function(p){p&&p.closePopup()},CPopups.prototype.removePopup=function(p){this.keyupPopupBound&&1===this.popups.length&&($(document).off("keyup",this.keyupPopupBound),this.keyupPopupBound=void 0),p.$popupDom&&(p.$popupDom.remove(),p.$popupDom=void 0),p.$templatePlace[0]&&p.$templatePlace[0].remove(),p.$templatePlace[1]&&p.$templatePlace[1].remove(),this.popups=_.without(this.popups,p)},module.exports=new CPopups;