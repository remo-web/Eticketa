"use strict";!function(e){function t(){this.objectTypes=ko.observableArray([]),this.objectsList=ko.observableArray([]),this.propsList=ko.observableArray([]),this.propsTypeList=ko.observableArray([]),this.searchField=ko.observable(),this.searchText=ko.observable(),this.selectedItem=ko.observable(null),this.selectedObjectName=ko.observable(null),this.checkedItems=ko.observableArray([]),this.switchTab=_.bind(this.switchTab,this),this.ajaxResponse=_.bind(this.ajaxResponse,this),this.selectItem=_.bind(this.selectItem,this),this.checkItem=_.bind(this.checkItem,this),this.postForm=_.bind(this.postForm,this),this.onPostResponse=_.bind(this.onPostResponse,this),this.init()}t.prototype.init=function(){return $.ajax({url:"?eav-viewer-action",context:this,type:"POST",data:{action:"types"},complete:this.ajaxTypesResponse,timeout:1e4}),!1},t.prototype.fillData=function(e){e&&e.Values&&e.Values.length>0?(this.propsList(_.map(e.Fields,function(e,t){return t})),this.propsTypeList(_.map(e.Fields,function(e){return e})),this.objectsList(_.map(e.Values,function(e){return _.values(e)}))):(this.propsList([]),this.propsTypeList([]),this.objectsList([]))},t.prototype.selectItem=function(e){return this.selectedItem()===e?(this.selectedItem(null),1===this.checkedItems().length&&this.checkedItems([])):(this.selectedItem(e),0===this.checkedItems().length?this.checkedItems.push(e[0]):1===this.checkedItems().length&&this.checkedItems([e[0]])),!0},t.prototype.checkItem=function(e,t){return t.stopPropagation(),_.contains(this.checkedItems(),e[0])?this.checkedItems.remove(e[0]):this.checkedItems.push(e[0]),this.selectedItem()||this.selectedItem(e),!0},t.prototype.switchTab=function(e){return this.searchText(""),this.selectedItem(null),this.checkedItems([]),this.selectedObjectName(e),$.ajax({url:"?eav-viewer-action",context:this,type:"POST",data:{action:"list",ObjectName:e},complete:this.ajaxResponse,timeout:1e4}),!1},t.prototype.searchClick=function(){return $.ajax({url:"?eav-viewer-action",context:this,type:"POST",data:{action:"list",ObjectName:this.selectedObjectName(),searchField:this.searchField(),searchText:this.searchText()},complete:this.ajaxResponse,timeout:1e4}),!1},t.prototype.ajaxTypesResponse=function(e,t){if("success"===t){var s=JSON.parse(e.responseText);this.objectTypes(s.result)}else console.log("ajaxResponse",t)},t.prototype.ajaxResponse=function(e,t){if("success"===t){var s=JSON.parse(e.responseText);this.fillData(s.result)}else console.log("ajaxResponse",t)},t.prototype.postForm=function(e,t){var s=$(t.currentTarget).closest("form").serialize();return $.ajax({url:"?eav-viewer-action",context:this,type:"POST",data:s,complete:this.onPostResponse,timeout:1e4}),!1},t.prototype.onPostResponse=function(e,t){"success"===t?this.switchTab(this.selectedObjectName()):console.log("ajaxResponse",t)},$(function(){ko.applyBindings(new t,document.getElementById("objects-screen"))})}(window);