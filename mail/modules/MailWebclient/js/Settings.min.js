"use strict";var ko=require("knockout"),_=require("underscore"),Types=require("%PathToCoreWebclientModule%/js/utils/Types.js"),App=require("%PathToCoreWebclientModule%/js/App.js");module.exports={ServerModuleName:"Mail",HashModuleName:"mail",FetchersServerModuleName:"MtaConnector",EnableMultiTenant:!1,AllowAddAccounts:!1,AllowAutosaveInDrafts:!0,AllowChangeMailQuotaOnMailServer:!1,AllowDefaultAccountForUser:!0,AllowEditDomainsInServer:!0,AllowFetchers:!1,AllowIdentities:!1,OnlyUserEmailsInIdentities:!1,AllowInsertImage:!0,AllowMultiAccounts:!1,AutoSaveIntervalSeconds:60,AllowTemplateFolders:!1,AllowAlwaysRefreshFolders:!1,AutocreateMailAccountOnNewUserFirstLogin:!1,IgnoreImapSubscription:!1,ImageUploadSizeLimit:0,AllowAppRegisterMailto:!1,AllowChangeInputDirection:!0,FoldersExpandedByDefault:!1,AllowSpamFolder:!0,AllowAddNewFolderOnMainScreen:!1,ComposeToolbarOrder:["back","send","save","importance","MailSensitivity","confirmation","OpenPgp"],DefaultFontName:"Tahoma",DefaultFontSize:3,AlwaysTryUseImageWhilePasting:!0,JoinReplyPrefixes:!0,MailsPerPage:20,MaxMessagesBodiesSizeToPrefetch:5e4,MessageBodyTruncationThreshold:65e4,MessagesSortBy:{},ShowEmailAsTabName:!0,AllowShowMessagesCountInFolderList:!1,showMessagesCountInFolderList:ko.observable(!1),AllowSearchMessagesBySubject:!1,PrefixesToRemoveBeforeSearchMessagesBySubject:[],AllowHorizontalLayout:!1,HorizontalLayout:!1,HorizontalLayoutByDefault:!1,userMailAccountsCount:ko.observable(0),mailAccountsEmails:ko.observableArray([]),init:function(e){var s=e.Core,o=e[this.ServerModuleName],t=e["%ModuleName%"],l=e[this.FetchersServerModuleName];if(_.isEmpty(s)||(this.EnableMultiTenant=Types.pBool(s.EnableMultiTenant,this.EnableMultiTenant)),!_.isEmpty(o)){this.AllowAddAccounts=Types.pBool(o.AllowAddAccounts,this.AllowAddAccounts),this.AllowAutosaveInDrafts=Types.pBool(o.AllowAutosaveInDrafts,this.AllowAutosaveInDrafts),this.AllowChangeMailQuotaOnMailServer=Types.pBool(o.AllowChangeMailQuotaOnMailServer,this.AllowChangeMailQuotaOnMailServer),this.AllowDefaultAccountForUser=Types.pBool(o.AllowDefaultAccountForUser,this.AllowDefaultAccountForUser),this.AllowEditDomainsInServer=Types.pBool(o.AllowEditDomainsInServer,this.AllowEditDomainsInServer),this.AllowIdentities=Types.pBool(o.AllowIdentities,this.AllowIdentities),this.OnlyUserEmailsInIdentities=Types.pBool(o.OnlyUserEmailsInIdentities,this.OnlyUserEmailsInIdentities),this.AllowInsertImage=Types.pBool(o.AllowInsertImage,this.AllowInsertImage),this.AllowMultiAccounts=Types.pBool(o.AllowMultiAccounts,this.AllowMultiAccounts),this.AutoSaveIntervalSeconds=Types.pNonNegativeInt(o.AutoSaveIntervalSeconds,this.AutoSaveIntervalSeconds),this.AllowTemplateFolders=Types.pBool(o.AllowTemplateFolders,this.AllowTemplateFolders),this.AllowAlwaysRefreshFolders=Types.pBool(o.AllowAlwaysRefreshFolders,this.AllowAlwaysRefreshFolders),this.AutocreateMailAccountOnNewUserFirstLogin=Types.pBool(o.AutocreateMailAccountOnNewUserFirstLogin,this.AutocreateMailAccountOnNewUserFirstLogin),this.IgnoreImapSubscription=Types.pBool(o.IgnoreImapSubscription,this.IgnoreImapSubscription),this.ImageUploadSizeLimit=Types.pNonNegativeInt(o.ImageUploadSizeLimit,this.ImageUploadSizeLimit),window.Enums.SmtpAuthType=Types.pObject(o.SmtpAuthType),this.MessagesSortBy=_.clone(Types.pObject(o.MessagesSortBy,this.MessagesSortBy)),this.MessagesSortBy.Allow=Types.pBool(this.MessagesSortBy.Allow,!1),this.MessagesSortBy.List=Types.pArray(this.MessagesSortBy.List,[]),this.MessagesSortBy.DefaultSortBy=Types.pString(this.MessagesSortBy.DefaultSortBy,"arrival");var i=Types.pString(this.MessagesSortBy.DefaultSortOrder,"desc");this.MessagesSortBy.DefaultSortOrder="desc"===i?Enums.SortOrder.Desc:Enums.SortOrder.Asc}_.isEmpty(t)||(this.AllowAppRegisterMailto=Types.pBool(t.AllowAppRegisterMailto,this.AllowAppRegisterMailto),this.AllowChangeInputDirection=Types.pBool(t.AllowChangeInputDirection,this.AllowChangeInputDirection),this.FoldersExpandedByDefault=Types.pBool(t.FoldersExpandedByDefault,this.FoldersExpandedByDefault),this.AllowSpamFolder=Types.pBool(t.AllowSpamFolder,this.AllowSpamFolder),this.AllowAddNewFolderOnMainScreen=Types.pBool(t.AllowAddNewFolderOnMainScreen,this.AllowAddNewFolderOnMainScreen),this.ComposeToolbarOrder=Types.pArray(t.ComposeToolbarOrder,this.ComposeToolbarOrder),this.DefaultFontName=Types.pString(t.DefaultFontName,this.DefaultFontName),this.DefaultFontSize=Types.pPositiveInt(t.DefaultFontSize,this.DefaultFontSize),this.AlwaysTryUseImageWhilePasting=Types.pBool(t.AlwaysTryUseImageWhilePasting,this.AlwaysTryUseImageWhilePasting),this.JoinReplyPrefixes=Types.pBool(t.JoinReplyPrefixes,this.JoinReplyPrefixes),this.MailsPerPage=Types.pPositiveInt(t.MailsPerPage,this.MailsPerPage),this.MaxMessagesBodiesSizeToPrefetch=Types.pNonNegativeInt(t.MaxMessagesBodiesSizeToPrefetch,this.MaxMessagesBodiesSizeToPrefetch),this.MessageBodyTruncationThreshold=Types.pNonNegativeInt(t.MessageBodyTruncationThreshold,this.MessageBodyTruncationThreshold),this.ShowEmailAsTabName=Types.pBool(t.ShowEmailAsTabName,this.ShowEmailAsTabName),this.AllowShowMessagesCountInFolderList=Types.pBool(t.AllowShowMessagesCountInFolderList,this.AllowShowMessagesCountInFolderList),this.showMessagesCountInFolderList(Types.pBool(t.ShowMessagesCountInFolderList,this.showMessagesCountInFolderList())),this.AllowSearchMessagesBySubject=Types.pBool(t.AllowSearchMessagesBySubject,this.AllowSearchMessagesBySubject),this.PrefixesToRemoveBeforeSearchMessagesBySubject=Types.pArray(t.PrefixesToRemoveBeforeSearchMessagesBySubject,this.PrefixesToRemoveBeforeSearchMessagesBySubject),this.AllowHorizontalLayout=Types.pBool(t.AllowHorizontalLayout,this.AllowHorizontalLayout),this.HorizontalLayout=this.AllowHorizontalLayout&&Types.pBool(t.HorizontalLayout,this.HorizontalLayout),this.HorizontalLayoutByDefault=this.AllowHorizontalLayout&&Types.pBool(t.HorizontalLayoutByDefault,this.HorizontalLayoutByDefault)),_.isEmpty(l)||(this.AllowFetchers=Types.pBool(l.AllowFetchers,this.AllowFetchers)),App.registerUserAccountsCount(this.userMailAccountsCount),App.registerAccountsWithPass(this.mailAccountsEmails)},update:function(e,s,o,t){this.AllowAutosaveInDrafts=Types.pBool(s,this.AllowAutosaveInDrafts),this.AllowChangeInputDirection=Types.pBool(o,this.AllowChangeInputDirection),this.MailsPerPage=Types.pPositiveInt(e,this.MailsPerPage),this.showMessagesCountInFolderList(Types.pBool(t,this.showMessagesCountInFolderList()))},updateAdmin:function(e,s,o){this.AutocreateMailAccountOnNewUserFirstLogin=Types.pBool(e,this.AutocreateMailAccountOnNewUserFirstLogin),this.AllowAddAccounts=Types.pBool(s,this.AllowAddAccounts),this.HorizontalLayoutByDefault=Types.pBool(o,this.HorizontalLayoutByDefault)},disableEditDomainsInServer:function(){this.AllowEditDomainsInServer=!1}};