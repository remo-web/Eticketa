"use strict";var _=require("underscore"),$=require("jquery"),ko=require("knockout"),ModulesManager=require("%PathToCoreWebclientModule%/js/ModulesManager.js"),ComposeMessageToAddressesFunc=ModulesManager.run("MailWebclient","getComposeMessageToAddresses");$.isFunction(ComposeMessageToAddressesFunc)&&(ko.bindingHandlers.makeLinkComposeMailTo={update:function(e,n,o,s,a){var i=$(e),t=n();i.show(),i.hasClass("button")||i.addClass("link"),i.click(function(){ComposeMessageToAddressesFunc(t)})}}),ko.bindingHandlers.moveToFolderFilter={init:function(e,n,o,s,a){var i=$(e),t=n(),u=$(e).find(t.container),l=_.isArray(t.options)?t.options:t.options(),r=t.value?t.value():"";_.find(l,function(e){return e[t.optionsValue]===r})||(r="",t.value("")),i.removeClass("expand"),u.empty(),_.each(l,function(e){var n=$('<span class="item"></span>').text(e[t.optionsText]).data("value",e[t.optionsValue]);r===e[t.optionsValue]&&n.addClass("selected"),e.jq=n,u.append(n)}),u.on("click",".item",function(){var e=$(this).data("value");t.value(e)}),i.click(function(){i.toggleClass("expand"),i.hasClass("expand")&&_.defer(function(){$(document).one("click",function(){i.removeClass("expand")})})})},update:function(e,n){var o=$(e),s=n(),a=_.isArray(s.options)?s.options:s.options(),i=s.value?s.value():"",t=_.find(a,function(e){return e[s.optionsValue]===i}),u=o.find(".link");_.each(a,function(e){e.jq&&e.jq.toggleClass("selected",i===e[s.optionsValue])}),t&&u.text($.trim(t[s.optionsText]))}};