"use strict";function CSetSystemFoldersPopup(){CAbstractPopup.call(this),this.folders=MailCache.editedFolderList,this.sentFolderFullName=ko.observable(""),this.draftsFolderFullName=ko.observable(""),this.spamFolderFullName=ko.observable(""),this.trashFolderFullName=ko.observable(""),this.options=ko.observableArray([]),this.defaultOptionsAfterRender=Utils.defaultOptionsAfterRender,this.bAllowSpamFolderEditing=Settings.AllowSpamFolder}var _=require("underscore"),ko=require("knockout"),TextUtils=require("%PathToCoreWebclientModule%/js/utils/Text.js"),Utils=require("%PathToCoreWebclientModule%/js/utils/Common.js"),Api=require("%PathToCoreWebclientModule%/js/Api.js"),CAbstractPopup=require("%PathToCoreWebclientModule%/js/popups/CAbstractPopup.js"),AccountList=require("modules/%ModuleName%/js/AccountList.js"),Ajax=require("modules/%ModuleName%/js/Ajax.js"),MailCache=require("modules/%ModuleName%/js/Cache.js"),Settings=require("modules/%ModuleName%/js/Settings.js");_.extendOwn(CSetSystemFoldersPopup.prototype,CAbstractPopup.prototype),CSetSystemFoldersPopup.prototype.PopupTemplate="%ModuleName%_Settings_SetSystemFoldersPopup",CSetSystemFoldersPopup.prototype.onOpen=function(){var e=MailCache.editedFolderList();this.options(e.getOptions(TextUtils.i18n("%MODULENAME%/LABEL_NO_FOLDER_USAGE_ASSIGNED"),!1,!1,!1)),this.sentFolderFullName(e.sentFolderFullName()),this.draftsFolderFullName(e.draftsFolderFullName()),Settings.AllowSpamFolder&&this.spamFolderFullName(e.spamFolderFullName()),this.trashFolderFullName(e.trashFolderFullName())},CSetSystemFoldersPopup.prototype.onResponseFoldersSetupSystem=function(e,l){!1===e.Result&&(Api.showErrorByCode(e,TextUtils.i18n("%MODULENAME%/ERROR_SETUP_SPECIAL_FOLDERS")),MailCache.getFolderList(AccountList.editedId()))},CSetSystemFoldersPopup.prototype.apply=function(){var e=MailCache.editedFolderList(),l=!1,t=null;this.sentFolderFullName()!==e.sentFolderFullName()&&(e.sentFolderFullName(this.sentFolderFullName()),l=!0),this.draftsFolderFullName()!==e.draftsFolderFullName()&&(e.draftsFolderFullName(this.draftsFolderFullName()),l=!0),Settings.AllowSpamFolder&&this.spamFolderFullName()!==e.spamFolderFullName()&&(e.spamFolderFullName(this.spamFolderFullName()),l=!0),this.trashFolderFullName()!==e.trashFolderFullName()&&(e.trashFolderFullName(this.trashFolderFullName()),l=!0),l&&(t={AccountID:AccountList.editedId(),Sent:e.sentFolderFullName(),Drafts:e.draftsFolderFullName(),Trash:e.trashFolderFullName(),Spam:e.spamFolderFullName()},Ajax.send("SetupSystemFolders",t,this.onResponseFoldersSetupSystem,this)),this.closePopup()},module.exports=new CSetSystemFoldersPopup;