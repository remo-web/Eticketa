"use strict";var $=require("jquery"),TextUtils=require("%PathToCoreWebclientModule%/js/utils/Text.js"),UrlUtils=require("%PathToCoreWebclientModule%/js/utils/Url.js"),Storage=require("%PathToCoreWebclientModule%/js/Storage.js"),UserSettings=require("%PathToCoreWebclientModule%/js/Settings.js"),Popups=require("%PathToCoreWebclientModule%/js/Popups.js"),ConfirmPopup=require("%PathToCoreWebclientModule%/js/popups/ConfirmPopup.js"),MailCache=require("modules/%ModuleName%/js/Cache.js"),MailUtils={};MailUtils.deleteMessages=function(e,t){$.isFunction(t)||(t=function(){});var o=MailCache.folderList(),i=o.currentFolderFullName(),s=o.trashFolder(),l=s&&i===s.fullName(),r=o.spamFolder(),a=function(o){o&&(MailCache.deleteMessages(e),t())};r&&i===r.fullName()?(MailCache.deleteMessages(e),t()):l?Popups.showPopup(ConfirmPopup,[TextUtils.i18n("%MODULENAME%/CONFIRM_DELETE_MESSAGES_PLURAL",{},null,e.length),a,"",TextUtils.i18n("COREWEBCLIENT/ACTION_DELETE")]):s?(MailCache.moveMessagesToFolder(s.fullName(),e),t()):s||Popups.showPopup(ConfirmPopup,[TextUtils.i18n("%MODULENAME%/CONFIRM_MESSAGES_DELETE_NO_TRASH_FOLDER"),a])},MailUtils.registerMailto=function(e){!window.navigator||!$.isFunction(window.navigator.registerProtocolHandler)||e&&!0===Storage.getData("MailtoAsked")||(window.navigator.registerProtocolHandler("mailto",UrlUtils.getAppPath()+"#mail/compose/to/%s",""!==UserSettings.SiteName?UserSettings.SiteName:"WebMail"),Storage.setData("MailtoAsked",!0))},module.exports=MailUtils;