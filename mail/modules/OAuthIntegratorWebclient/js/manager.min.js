"use strict";module.exports=function(e){var r=require("underscore"),t=require("jquery"),o=require("knockout"),n=require("%PathToCoreWebclientModule%/js/Routing.js"),i=require("%PathToCoreWebclientModule%/js/Ajax.js"),u=require("%PathToCoreWebclientModule%/js/App.js"),s=require("modules/%ModuleName%/js/Settings.js"),a=u.getUserRole()===Enums.UserRole.Anonymous;return s.init(e),a?{start:function(e){s.oauthServices=o.observableArray([]);var r=function(e){if("CLoginView"===e.Name||"CRegisterView"===e.Name){(function(){var e=n.getCurrentHashArray();e.length>=2&&e[0]===s.RegisterModuleHash&&e[1]})();e.View.externalAuthClick=function(r){t.cookie("oauth-redirect","CLoginView"===e.Name?"login":"register"),t.cookie("oauth-scopes","auth"),window.location.href="?oauth="+r},e.View.oauthServices=s.oauthServices}};i.send(s.ServerModuleName,"GetServices",null,function(e){s.oauthServices(e.Result)},this),u.subscribeEvent("StandardLoginFormWebclient::ConstructView::after",r),u.subscribeEvent("StandardRegisterFormWebclient::ConstructView::after",r)}}:u.isUserNormalOrTenant()?{start:function(e){var t=function(){i.send(s.ServerModuleName,"GetAccounts",null,function(e){var t=0;r.isArray(e.Result)&&r.each(e.Result,function(e){-1!==e.Scopes.indexOf("auth")&&t++}),s.userAccountsCount(t)})};u.subscribeEvent("OAuthAccountChange::after",function(){t()}),t()},getCreateLoginPasswordView:function(){return require("modules/%ModuleName%/js/views/CreateLoginPasswordView.js")}}:null};