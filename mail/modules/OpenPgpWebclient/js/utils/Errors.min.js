"use strict";var _=require("underscore"),TextUtils=require("%PathToCoreWebclientModule%/js/utils/Text.js"),Screens=require("%PathToCoreWebclientModule%/js/Screens.js"),Enums=require("modules/%ModuleName%/js/Enums.js"),ErrorsUtils={};ErrorsUtils.showPgpErrorByCode=function(E,r,e){var s=_.isArray(E.errors)?E.errors:[],n=_.isArray(E.notices)?E.notices:[],t=[],R=[],i="",O=!1,o=!0;if(_.each(_.union(s,n),function(E){if(2===E.length)switch(E[0]){case Enums.OpenPgpErrors.GenerateKeyError:i=TextUtils.i18n("%MODULENAME%/ERROR_GENERATE_KEY");break;case Enums.OpenPgpErrors.ImportKeyError:i=TextUtils.i18n("%MODULENAME%/ERROR_IMPORT_KEY");break;case Enums.OpenPgpErrors.ImportNoKeysFoundError:i=TextUtils.i18n("%MODULENAME%/ERROR_IMPORT_NO_KEY_FOUND");break;case Enums.OpenPgpErrors.PrivateKeyNotFoundError:case Enums.OpenPgpErrors.PrivateKeyNotFoundNotice:R.push(E[1]);break;case Enums.OpenPgpErrors.PublicKeyNotFoundError:o=!1,t.push(E[1]);break;case Enums.OpenPgpErrors.PublicKeyNotFoundNotice:t.push(E[1]);break;case Enums.OpenPgpErrors.KeyIsNotDecodedError:i=r===Enums.PgpAction.DecryptVerify?TextUtils.i18n("%MODULENAME%/ERROR_DECRYPT")+" "+TextUtils.i18n("%MODULENAME%/ERROR_KEY_NOT_DECODED",{USER:E[1]}):r===Enums.PgpAction.Sign||r===Enums.PgpAction.EncryptSign?TextUtils.i18n("%MODULENAME%/ERROR_SIGN")+" "+TextUtils.i18n("%MODULENAME%/ERROR_KEY_NOT_DECODED",{USER:E[1]}):TextUtils.i18n("%MODULENAME%/ERROR_KEY_NOT_DECODED",{USER:E[1]});break;case Enums.OpenPgpErrors.SignError:i=TextUtils.i18n("%MODULENAME%/ERROR_SIGN");break;case Enums.OpenPgpErrors.VerifyError:i=TextUtils.i18n("%MODULENAME%/ERROR_VERIFY");break;case Enums.OpenPgpErrors.EncryptError:i=TextUtils.i18n("%MODULENAME%/ERROR_ENCRYPT");break;case Enums.OpenPgpErrors.DecryptError:i=TextUtils.i18n("%MODULENAME%/ERROR_DECRYPT");break;case Enums.OpenPgpErrors.SignAndEncryptError:i=TextUtils.i18n("%MODULENAME%/ERROR_ENCRYPT_OR_SIGN");break;case Enums.OpenPgpErrors.VerifyAndDecryptError:i=TextUtils.i18n("%MODULENAME%/ERROR_DECRYPT_OR_VERIFY");break;case Enums.OpenPgpErrors.DeleteError:i=TextUtils.i18n("%MODULENAME%/ERROR_DELETE_KEY");break;case Enums.OpenPgpErrors.VerifyErrorNotice:i=TextUtils.i18n("%MODULENAME%/ERROR_VERIFY");break;case Enums.OpenPgpErrors.NoSignDataNotice:O=!0;break;case Enums.OpenPgpErrors.CanNotReadMessage:i=TextUtils.i18n("%MODULENAME%/ERROR_CAN_NOT_READ_MESSAGE");break;default:i=TextUtils.i18n("COREWEBCLIENT/ERROR_UNKNOWN")}}),t.length>0?((t=_.without(t,"")).length>0?i=TextUtils.i18n("%MODULENAME%/ERROR_NO_PUBLIC_KEYS_FOR_USERS_PLURAL",{USERS:t.join(", ")},null,t.length):r===Enums.PgpAction.Verify&&(i=TextUtils.i18n("%MODULENAME%/ERROR_NO_PUBLIC_KEY_FOUND_FOR_VERIFY")),o&&""!==i&&(i+=" "+TextUtils.i18n("%MODULENAME%/ERROR_MESSAGE_WAS_NOT_VERIFIED"))):R.length>0&&((R=_.without(R,"")).length>0?i=TextUtils.i18n("%MODULENAME%/ERROR_NO_PRIVATE_KEYS_FOR_USERS_PLURAL",{USERS:R.join(", ")},null,R.length):r===Enums.PgpAction.DecryptVerify&&(i=TextUtils.i18n("%MODULENAME%/ERROR_NO_PRIVATE_KEY_FOUND_FOR_DECRYPT"))),""===i&&!O)switch(r){case Enums.PgpAction.Generate:i=TextUtils.i18n("%MODULENAME%/ERROR_GENERATE_KEY");break;case Enums.PgpAction.Import:i=TextUtils.i18n("%MODULENAME%/ERROR_IMPORT_KEY");break;case Enums.PgpAction.DecryptVerify:i=TextUtils.i18n("%MODULENAME%/ERROR_DECRYPT");break;case Enums.PgpAction.Verify:i=TextUtils.i18n("%MODULENAME%/ERROR_VERIFY");break;case Enums.PgpAction.Encrypt:i=TextUtils.i18n("%MODULENAME%/ERROR_ENCRYPT");break;case Enums.PgpAction.EncryptSign:i=TextUtils.i18n("%MODULENAME%/ERROR_ENCRYPT_OR_SIGN");break;case Enums.PgpAction.Sign:i=TextUtils.i18n("%MODULENAME%/ERROR_SIGN")}return""===i&&e&&(i=e),""===i&&(i=TextUtils.i18n("COREWEBCLIENT/ERROR_UNKNOWN")),""!==i&&Screens.showError(i),O},module.exports=ErrorsUtils;