"use strict";function CVerifyTokenPopup(){CAbstractPopup.call(this),this.onConfirm=null,this.onCancel=null,this.pin=ko.observable(""),this.inPropgress=ko.observable(!1),this.UserId=null,this.pinFocused=ko.observable(!1),this.isMobile=ko.observable(App.isMobile()||!1)}var _=require("underscore"),ko=require("knockout"),Screens=require("%PathToCoreWebclientModule%/js/Screens.js"),TextUtils=require("%PathToCoreWebclientModule%/js/utils/Text.js"),CAbstractPopup=require("%PathToCoreWebclientModule%/js/popups/CAbstractPopup.js"),Ajax=require("%PathToCoreWebclientModule%/js/Ajax.js"),App=require("%PathToCoreWebclientModule%/js/App.js");_.extendOwn(CVerifyTokenPopup.prototype,CAbstractPopup.prototype),CVerifyTokenPopup.prototype.PopupTemplate="%ModuleName%_VerifyTokenPopup",CVerifyTokenPopup.prototype.onOpen=function(e,o,i){this.onConfirm=e,this.onCancel=o,this.UserId=i,this.pinFocused(!0)},CVerifyTokenPopup.prototype.verifyPin=function(){this.inPropgress(!0),Ajax.send("TwoFactorAuth","VerifyPin",{Pin:this.pin(),UserId:this.UserId},this.onGetVerifyResponse,this)},CVerifyTokenPopup.prototype.onGetVerifyResponse=function(e){e.Result?(_.isFunction(this.onConfirm)&&this.onConfirm(e),this.closePopup(),this.pin("")):(Screens.showError(TextUtils.i18n("%MODULENAME%/ERROR_WRONG_PIN")),this.pin("")),this.inPropgress(!1)},CVerifyTokenPopup.prototype.cancelPopup=function(){_.isFunction(this.onCancel)&&this.onCancel(!1),this.closePopup()},module.exports=new CVerifyTokenPopup;