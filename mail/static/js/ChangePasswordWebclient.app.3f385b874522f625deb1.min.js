(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"3Y+r":function(s,o,n){"use strict";var t=n("F/us"),e=n("SQrT"),r={};r.checkIfFieldsEmpty=function(s,o){var n=t.find(s,function(s){return""===s()});return!n||(o&&e.showError(o),n.focused(!0),!1)},r.checkPassword=function(s,o){var t=n("RN+F"),r=n("hPb3"),i=!1;return o!==s?e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):r.PasswordMinLength>0&&s.length<r.PasswordMinLength?e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",r.PasswordMinLength)):!r.PasswordMustBeComplex||s.match(/([0-9])/)&&s.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?i=!0:e.showError(t.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),i},s.exports=r},"4RXH":function(s,o,n){"use strict";var t=n("F/us"),e=n("AFLV");s.exports={ShowSingleMailChangePasswordInCommonSettings:!1,init:function(s){var o=s.ChangePasswordWebclient;t.isEmpty(o)||(this.ShowSingleMailChangePasswordInCommonSettings=e.pBool(o.ShowSingleMailChangePasswordInCommonSettings,this.ShowSingleMailChangePasswordInCommonSettings))}}},MLmf:function(s,o,n){"use strict";s.exports=function(s){if(n("IAk5").isUserNormalOrTenant()){var o=n("4RXH");return o.init(s),{start:function(s){o.ShowSingleMailChangePasswordInCommonSettings&&s.run("SettingsWebclient","registerSettingsTabSection",[function(){return n("btIU")},"common","common"])},getChangePasswordPopup:function(){return n("a7cI")},isChangePasswordButtonAllowed:function(s,n){return(!o.ShowSingleMailChangePasswordInCommonSettings||s>1)&&!!n.aExtend.AllowChangePasswordOnMailServer}}}return null}},a7cI:function(s,o,n){"use strict";function t(){S.call(this),this.currentPassword=i.observable(""),this.newPassword=i.observable(""),this.confirmPassword=i.observable(""),this.accountId=i.observable(""),this.hasOldPassword=i.observable(!1),this.oParams=null}var e=n("F/us"),r=n("EVdn"),i=n("0h2I"),a=n("RN+F"),h=(n("ZP6a"),n("3Y+r")),c=n("o0Bx"),u=n("JFZZ"),d=n("IAk5"),l=n("SQrT"),w=n("76Kh"),P=n("1grR"),S=n("czxF");n("4RXH");e.extendOwn(t.prototype,S.prototype),t.prototype.PopupTemplate="ChangePasswordWebclient_ChangePasswordPopup",t.prototype.onOpen=function(s){this.currentPassword(""),this.newPassword(""),this.confirmPassword(""),this.accountId(s.iAccountId),this.hasOldPassword(s.bHasOldPassword),this.oParams=s},t.prototype.change=function(){var s=r.trim(this.newPassword()),o=r.trim(this.confirmPassword());h.checkPassword(s,o)&&this.sendChangeRequest()},t.prototype.sendChangeRequest=function(){var s={AccountId:this.accountId(),CurrentPassword:r.trim(this.currentPassword()),NewPassword:r.trim(this.newPassword())},o={Module:this.oParams.sModule,Method:"ChangePassword"};c.send(this.oParams.sModule,"ChangePassword",s,this.onUpdatePasswordResponse,this),c.abortAndStopSendRequests(o)},t.prototype.onUpdatePasswordResponse=function(s,o){!1===s.Result?(u.showErrorByCode(s,a.i18n("CHANGEPASSWORDWEBCLIENT/ERROR_PASSWORD_NOT_SAVED")),c.startSendRequests()):s.Result&&s.Result.RefreshToken?(d.setAuthToken(s.Result.RefreshToken),w.showPopup(P,[a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")+" "+a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_REDIRECT_TO_LOGIN"),function(){d.logout()}])):(this.hasOldPassword()?l.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_CHANGED")):l.showReport(a.i18n("CHANGEPASSWORDWEBCLIENT/REPORT_PASSWORD_SET")),this.closePopup(),r.isFunction(this.oParams.fAfterPasswordChanged)&&this.oParams.fAfterPasswordChanged())},s.exports=new t},btIU:function(s,o,n){"use strict";function t(){this.oSingleMailAccount=null,this.showChangePasswordButton=r.observable(!1),this.init()}var e=n("F/us"),r=n("0h2I"),i=n("OgeD"),a=n("76Kh"),h=i.run("ChangePasswordWebclient","getChangePasswordPopup");n("4RXH");t.prototype.ViewTemplate="ChangePasswordWebclient_ChangeSingleMailAccountPasswordView",t.prototype.init=function(){var s=i.run("MailWebclient","getAccountList",[]),o=function(){1===s.collection().length?(this.oSingleMailAccount=s.collection()[0],this.showChangePasswordButton(!0)):(this.oSingleMailAccount=null,this.showChangePasswordButton(!1))}.bind(this);s&&e.isFunction(s.collection)&&(o(),s.collection.subscribe(o))},t.prototype.changePassword=function(){this.oSingleMailAccount&&a.showPopup(h,[{iAccountId:this.oSingleMailAccount.id(),sModule:"Mail",bHasOldPassword:!0}])},s.exports=new t}}]);