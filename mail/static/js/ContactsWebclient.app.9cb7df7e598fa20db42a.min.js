(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+JH/":function(t,e,s){"use strict";var i=s("F/us"),o=s("AFLV");t.exports={ServerModuleName:"Contacts",HashModuleName:"contacts",ContactsPerPage:20,ImportContactsLink:"",Storages:[],DefaultStorage:"personal",ImportExportFormats:[],SaveVcfServerModuleName:"",EContactsPrimaryEmail:{},EContactsPrimaryPhone:{},EContactsPrimaryAddress:{},EContactSortField:{},init:function(t){var e=t[this.ServerModuleName];i.isEmpty(e)||(this.ContactsPerPage=o.pPositiveInt(e.ContactsPerPage,this.ContactsPerPage),this.ImportContactsLink=o.pString(e.ImportContactsLink,this.ImportContactsLink),this.Storages=o.pArray(e.Storages,this.Storages),this.Storages.length>0&&(this.Storages.push("all"),this.Storages.push("group")),this.ImportExportFormats=o.pArray(e.ImportExportFormats,this.ImportExportFormats),this.SaveVcfServerModuleName=o.pString(e.SaveVcfServerModuleName,this.SaveVcfServerModuleName),this.EContactsPrimaryEmail=o.pObject(e.PrimaryEmail),this.EContactsPrimaryPhone=o.pObject(e.PrimaryPhone),this.EContactsPrimaryAddress=o.pObject(e.PrimaryAddress),this.EContactSortField=o.pObject(e.SortField))},update:function(t){this.ContactsPerPage=t}}},"/tOA":function(t,e,s){"use strict";function i(t){return"p"===t.substr(0,1)&&/^[1-9][\d]*$/.test(t.substr(1))}function o(t){return"cnt"===t.substr(0,3)}var n=s("EVdn"),r=s("AFLV"),a=s("+JH/"),l={};l.getContacts=function(t,e,s,i,o,n){var l=[a.HashModuleName];return t&&""!==t&&l.push(t),e&&""!==e&&l.push(e),s&&""!==s&&l.push(s),r.isNumber(i)&&l.push("p"+i),o&&""!==o&&l.push("cnt"+o),n&&""!==n&&l.push(n),l},l.parseContacts=function(t){var e=0,s=a.DefaultStorage,l="",h="",c=1,u="",p="";return r.isNonEmptyArray(t)&&(s=r.pString(t[e]),e++,-1===n.inArray(s,a.Storages)&&(s=a.DefaultStorage),"group"===s&&(t.length>e?(l=r.pString(t[e]),e++):s=a.DefaultStorage),t.length>e&&!i(t[e])&&!o(t[e])&&(h=r.pString(t[e]),e++),t.length>e&&i(t[e])&&(c=r.pInt(t[e].substr(1)),e++,c<=0&&(c=1)),t.length>e&&(o(t[e])?u=r.pString(t[e].substr(3)):p=r.pString(t[e]),e++)),{Storage:s,GroupUUID:l,Search:h,Page:c,ContactUUID:u,Action:p}},t.exports=l},"4UCw":function(t,e,s){"use strict";function i(){this.vcard=n.observable(null)}var o=s("F/us"),n=s("0h2I"),r=s("AFLV"),a=s("v6sP"),l=s("wudd");i.prototype.ViewTemplate="ContactsWebclient_VcardAttachmentView",i.prototype.doAfterPopulatingMessage=function(t){var e=t&&r.isNonEmptyArray(t.aExtend)?t.aExtend:[],s=o.find(e,function(t){return"Object/Aurora\\Modules\\Mail\\Classes\\Vcard"===t["@Object"]});if(s){var i=a.getVcard(s.File);i||(i=new l).parse(s),this.vcard(i)}else this.vcard(null)},t.exports=new i},"5hOJ":function(t,e,s){"use strict";function i(){this.iTimeStampInUTC=0,this.oMoment=null}var o=s("wd/R"),n=s("RN+F"),r=s("Yjhd"),a=s("hPb3");i.prototype.parse=function(t){this.iTimeStampInUTC=t,this.oMoment=o.unix(this.iTimeStampInUTC)},i.prototype.setDate=function(t,e,s){this.oMoment=o([t,e,s])},i.prototype.getTimeFormat=function(){return a.timeFormat()===window.Enums.TimeFormat.F24?"HH:mm":"hh:mm A"},i.prototype.getFullDate=function(){return this.getDate()+" "+this.getTime()},i.prototype.getMidDate=function(){return this.getShortDate(!0)},i.prototype.getShortDate=function(t){var e="",s=null;return this.oMoment&&((s=o()).format("L")===this.oMoment.format("L")?e=this.oMoment.format(this.getTimeFormat()):(e=s.clone().subtract(1,"days").format("L")===this.oMoment.format("L")?n.i18n("COREWEBCLIENT/LABEL_YESTERDAY"):a.UserSelectsDateFormat?this.oMoment.format(r.getDateFormatForMoment(a.dateFormat())):s.year()===this.oMoment.year()?this.oMoment.format("MMM D"):this.oMoment.format("MMM D, YYYY"),t&&(e+=", "+this.oMoment.format(this.getTimeFormat())))),e},i.prototype.getDate=function(){var t="ddd, MMM D, YYYY";return a.UserSelectsDateFormat&&(t="ddd, "+r.getDateFormatForMoment(a.dateFormat())),this.oMoment?this.oMoment.format(t):""},i.prototype.getTime=function(){return this.oMoment?this.oMoment.format(this.getTimeFormat()):""},i.prototype.getTimeStampInUTC=function(){return this.iTimeStampInUTC},t.exports=i},"5lSi":function(t,e,s){"use strict";t.exports=function(t){var e=s("F/us"),i=s("RN+F"),o=s("IAk5"),n=s("OgeD"),r=s("+JH/"),a=s("duUI"),l={getSuggestionsAutocompleteCallback:function(t,e,s){return function(i,o){a.callback(i,o,e,t,s)}},getSuggestionsAutocompletePhoneCallback:function(){return a.phoneCallback},getSuggestionsAutocompleteDeleteHandler:function(){return a.deleteHandler},requestUserByPhone:function(t,e,s){a.requestUserByPhone(t,e,s)}},h=function(){o.subscribeEvent("MailWebclient::RegisterMessagePaneController",function(t){t(s("4UCw"),"BeforeMessageBody")})},c={applyContactsCards:function(t){s("RpeT").applyTo(t)}};return r.init(t),n.isModuleAvailable(r.ServerModuleName)?(s("FRY1"),o.isUserNormalOrTenant()?o.isMobile()?e.extend({start:h,getSettings:function(){return r},getHeaderItemView:function(){return s("fG7T")}},l):o.isNewTab()?e.extend({start:h},l,c):(s("hhaf"),e.extend({start:function(t){t.run("SettingsWebclient","registerSettingsTab",[function(){return s("vLmA")},r.HashModuleName,i.i18n("CONTACTSWEBCLIENT/LABEL_SETTINGS_TAB")]),h()},getScreens:function(){var t={};return t[r.HashModuleName]=function(){return new(s("wSTV"))},t},getHeaderItem:function(){return{item:s("fG7T"),name:r.HashModuleName}},isTeamContactsAllowed:function(){return-1!==e.indexOf(r.Storages,"team")},getMobileSyncSettingsView:function(){return s("kQb/")}},l,c)):null):null}},B9Yq:function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},FRY1:function(t,e,s){"use strict";var i=s("F/us"),o=s("+JH/"),n={};n.ContactsPrimaryEmail=o.EContactsPrimaryEmail,n.ContactsPrimaryPhone=o.EContactsPrimaryPhone,n.ContactsPrimaryAddress=o.EContactsPrimaryAddress,n.ContactSortField=o.EContactSortField,void 0===window.Enums&&(window.Enums={}),i.extendOwn(window.Enums,n)},"Ig+v":function(t,e,s){function i(t){this.sName="",this.visible=o.observable(!0),this.baseHash=o.observable(""),this.hash=o.observable(""),this.linkText=o.observable(t),this.isCurrent=o.observable(!1),this.recivedAnim=o.observable(!1).extend({autoResetToFalse:500}),this.unseenCount=o.observable(0),this.allowChangeTitle=o.observable(!1),this.inactiveTitle=o.observable(""),this.excludedHashes=o.observableArray([])}var o=s("0h2I"),n=s("QaF5");i.prototype.ViewTemplate="CoreWebclient_HeaderItemView",i.prototype.setName=function(t){this.sName=t.toLowerCase(),""===this.baseHash()?(this.hash(n.buildHashFromArray([t.toLowerCase()])),this.baseHash(this.hash())):this.hash(this.baseHash())},t.exports=i},Is5a:function(t,e,s){"use strict";function i(){this.bIsGroup=!1,this.bIsOrganization=!1,this.bReadOnly=!1,this.bItsMe=!1,this.bTeam=!1,this.sUUID="",this.sName="",this.sEmail="",this.bSharedToAll=!1,this.aEmails=[],this.deleted=o.observable(!1),this.checked=o.observable(!1),this.selected=o.observable(!1),this.recivedAnim=o.observable(!1).extend({autoResetToFalse:500}),this.sStorage=a.DefaultStorage}var o=s("0h2I"),n=s("Ol7c"),r=s("AFLV"),a=s("+JH/");i.prototype.parse=function(t){this.sUUID=r.pString(t.UUID),this.sName=r.pString(t.FullName||t.Name),this.sEmail=r.pString(t.ViewEmail),r.isNonEmptyArray(t.Emails)&&(this.aEmails=t.Emails),this.bIsGroup=!!t.IsGroup,this.bIsOrganization=!!t.IsOrganization,this.bReadOnly=!!t.ReadOnly,this.bItsMe=!!t.ItsMe,this.bTeam="team"===t.Storage,this.bSharedToAll="shared"===t.Storage,this.sStorage=t.Storage},i.prototype.IsGroup=function(){return this.bIsGroup},i.prototype.Team=function(){return this.bTeam},i.prototype.ReadOnly=function(){return this.bReadOnly},i.prototype.ItsMe=function(){return this.bItsMe},i.prototype.UUID=function(){return this.sUUID},i.prototype.Name=function(){return this.sName},i.prototype.Email=function(){return this.sEmail},i.prototype.getFullEmail=function(){return n.getFullEmail(this.sName,this.sEmail)},i.prototype.IsSharedToAll=function(){return this.bSharedToAll},i.prototype.IsOrganization=function(){return this.bIsOrganization},t.exports=i},Mqix:function(t,e,s){"use strict";function i(){this.isNew=o.observable(!1),this.readOnly=o.observable(!1),this.uuid=o.observable(""),this.idUser=o.observable(0),this.name=o.observable(""),this.isOrganization=o.observable(!1),this.email=o.observable(""),this.country=o.observable(""),this.city=o.observable(""),this.company=o.observable(""),this.fax=o.observable(""),this.phone=o.observable(""),this.state=o.observable(""),this.street=o.observable(""),this.web=o.observable(""),this.zip=o.observable(""),this.edited=o.observable(!1),this.nameFocused=o.observable(!1),this.canBeSave=o.computed(function(){return""!==this.name()},this),this.newContactsInGroupCount=o.observable(0),this.newContactsInGroupHint=o.computed(function(){var t=this.newContactsInGroupCount();return this.isNew()&&0<t?r.i18n("CONTACTSWEBCLIENT/INFO_NEW_GROUP_CONTACTS_PLURAL",{COUNT:t},null,t):""},this),this.events=o.observableArray([])}var o=s("0h2I"),n=s("Ol7c"),r=s("RN+F"),a=s("IAk5");i.prototype.getFullEmail=function(){return n.getFullEmail(this.name(),this.email())},i.prototype.clear=function(){this.isNew(!1),this.uuid(""),this.idUser(0),this.name(""),this.nameFocused(!1),this.edited(!1),this.isOrganization(!1),this.email(""),this.country(""),this.city(""),this.company(""),this.fax(""),this.phone(""),this.state(""),this.street(""),this.web(""),this.zip(""),this.events([])},i.prototype.populate=function(t){this.isNew(t.isNew()),this.uuid(t.uuid()),this.idUser(t.idUser()),this.name(t.name()),this.nameFocused(t.nameFocused()),this.edited(t.edited()),this.isOrganization(t.isOrganization()),this.email(t.email()),this.country(t.country()),this.city(t.city()),this.company(t.company()),this.fax(t.fax()),this.phone(t.phone()),this.state(t.state()),this.street(t.street()),this.web(t.web()),this.zip(t.zip())},i.prototype.switchToNew=function(){this.clear(),this.edited(!0),this.isNew(!0),a.isMobile()||this.nameFocused(!0)},i.prototype.switchToView=function(){this.edited(!1)},i.prototype.toObject=function(t){return{UUID:this.uuid(),Name:this.name(),IsOrganization:this.isOrganization()?"1":"0",Email:this.email(),Country:this.country(),City:this.city(),Company:this.company(),Fax:this.fax(),Phone:this.phone(),State:this.state(),Street:this.street(),Web:this.web(),Zip:this.zip(),Contacts:t}},t.exports=i},PDX0:function(t,e){(function(e){t.exports=e}).call(this,{})},RpeT:function(t,e,s){"use strict";function i(t,e){var s=a("div.item_viewer[data-email='"+e+"']"),i=!1,o=0,n=function(){s&&t&&(i=!0,clearTimeout(o),setTimeout(function(){var e,o,n,r=t.offset();i&&r.left+r.top!==0&&(e=r.left+10,o=r.top+t.height()+6,(n=a(window).width()-(e+396))>0&&(n=0),s.addClass("expand").offset({top:o,left:e+n}))},180))},r=function(){i&&s&&t&&(i=!1,o=setTimeout(function(){i||s.removeClass("expand")},200))};s.length>0?(t.off().on("mouseover",function(){s.off().on("mouseenter",n).on("mouseleave",r).find(".link, .button").off(".links").on("click.links",function(){i=!1,s.removeClass("expand")}),setTimeout(function(){s.find(".link, .button").off("click.links").on("click.links",function(){i=!1,s.removeClass("expand")})}.bind(this),100),n()}).on("mouseout",r),i=!1,s.removeClass("expand")):t.off()}function o(t){t.next().hasClass("add_contact")&&t.next().remove(),t.removeClass("found"),t.parent().removeClass("found_contact"),t.off()}function n(t,e){r.each(t,function(s){var n=s.attr("data-email"),l=e[n];if(void 0!==l)if(o(s),null===l){var c=a('<span class="add_contact"></span>');s.after(c),h.init(c,"CONTACTSWEBCLIENT/ACTION_ADD_TO_CONTACTS"),c.on("click",function(){m.showPopup(f,[s.attr("data-name"),n,function(e){r.each(t,function(t){t.attr("data-email")===n&&(o(t),t.addClass("found"),t.parent().addClass("found_contact"),C.add(e),i(t,n))})}])})}else s.addClass("found"),s.parent().addClass("found_contact"),C.add(e),i(s,n)})}var r=s("F/us"),a=s("EVdn"),l=s("0h2I"),h=s("Do20"),c=s("OgeD"),u=s("SQrT"),p=c.run("MailWebclient","getComposeMessageToAddresses"),d=c.run("MailWebclient","getSearchMessagesInCurrentFolder"),m=s("76Kh"),f=s("be0C"),b=s("v6sP"),C={contacts:l.observableArray([]),ViewTemplate:"ContactsWebclient_ContactCardsView",bAllowComposeMessageToAddresses:r.isFunction(p),searchMessagesInCurrentFolder:d||function(){},bAllowSearchMessagesInCurrentFolder:r.isFunction(d),add:function(t){var e=r.filter(this.contacts(),function(e){return-1===a.inArray(e.email(),r.keys(t))});this.contacts(e.concat(r.compact(r.values(t))))}};u.showAnyView(C),t.exports={applyTo:function(t){var e=r.map(t,function(t){return a(t)}),s=r.uniq(r.map(e,function(t){return t&&t.attr("data-email")}));b.getContactsByEmails(s,r.bind(n,{},e))}}},YAzK:function(t,e,s){"use strict";function i(t){this.oJua=null,this.oParent=t,this.visibility=n.observable(!1),this.importing=n.observable(!1),this.importButtonDom=n.observable(null),this.bVisibleCloseButton=r.isMobile(),this.extensionInfo=t.getFormatDependentText("INFO_IMPORT_CONTACTS")}var o=s("F/us"),n=s("0h2I"),r=s("IAk5"),a=s("mjrp"),l=s("hPb3"),h=s("+JH/");i.prototype.ViewTemplate="ContactsWebclient_ImportView",i.prototype.onBind=function(){var t=o.map(h.ImportExportFormats,function(t){return"."+t});this.oJua=new a({action:"?/Api/",name:"jua-uploader",queueSize:1,clickElement:this.importButtonDom(),hiddenElementsPosition:l.IsRTL?"right":"left",disableAjaxUpload:!1,disableDragAndDrop:!0,disableMultiple:!0,hidden:o.extendOwn({Module:h.ServerModuleName,Method:"Import",Parameters:o.bind(function(){return JSON.stringify({GroupUUID:this.oParent.currentGroupUUID(),Storage:"personal"})},this)},r.getCommonRequestParameters()),accept:t.join(",")}),this.oJua.on("onSelect",o.bind(this.oParent.onImportSelect,this.oParent)).on("onStart",o.bind(this.onFileUploadStart,this)).on("onComplete",o.bind(this.onFileUploadComplete,this))},i.prototype.onFileUploadStart=function(){this.importing(!0)},i.prototype.onFileUploadComplete=function(t,e,s){this.importing(!1),this.oParent.onImportComplete(t,e,s)},t.exports=i},be0C:function(t,e,s){"use strict";function i(){u.call(this),this.displayName=r.observable(""),this.email=r.observable(""),this.phone=r.observable(""),this.address=r.observable(""),this.skype=r.observable(""),this.facebook=r.observable(""),this.focusDisplayName=r.observable(!1),this.loading=r.observable(!1),this.fCallback=function(){}}var o=s("F/us"),n=s("EVdn"),r=s("0h2I"),a=s("RN+F"),l=s("JFZZ"),h=s("QaF5"),c=s("SQrT"),u=s("czxF"),p=s("/tOA"),d=s("tYdA"),m=s("v6sP"),f=s("fG7T");o.extendOwn(i.prototype,u.prototype),i.prototype.PopupTemplate="ContactsWebclient_CreateContactPopup",i.prototype.onOpen=function(t,e,s){this.displayName()===t&&this.email()===e||(this.displayName(t),this.email(e),this.phone(""),this.address(""),this.skype(""),this.facebook("")),this.fCallback=n.isFunction(s)?s:function(){}},i.prototype.onSaveClick=function(){if(this.canBeSave()){if(!this.loading()){var t={PrimaryEmail:Enums.ContactsPrimaryEmail.Personal,FullName:this.displayName(),PersonalEmail:this.email(),PersonalPhone:this.phone(),PersonalAddress:this.address(),Skype:this.skype(),Facebook:this.facebook(),Storage:"personal"};this.loading(!0),d.send("CreateContact",{Contact:t},this.onCreateContactResponse,this)}}else c.showError(a.i18n("CONTACTSWEBCLIENT/ERROR_EMAIL_OR_NAME_BLANK"))},i.prototype.cancelPopup=function(){this.loading(!1),this.closePopup()},i.prototype.onCreateContactResponse=function(t,e){var s=e.Parameters;this.loading(!1),t.Result?(c.showReport(a.i18n("CONTACTSWEBCLIENT/REPORT_CONTACT_SUCCESSFULLY_ADDED")),m.clearInfoAboutEmail(s.Contact.PersonalEmail),m.getContactsByEmails([s.Contact.PersonalEmail],this.fCallback),this.closePopup(),f.isCurrent()||f.recivedAnim(!0)):l.showErrorByCode(t,a.i18n("CONTACTSWEBCLIENT/ERROR_CREATE_CONTACT"))},i.prototype.canBeSave=function(){return""!==this.displayName()||""!==this.email()},i.prototype.goToContacts=function(){m.saveNewContactParams({displayName:this.displayName(),email:this.email(),phone:this.phone(),address:this.address(),skype:this.skype(),facebook:this.facebook()}),this.closePopup(),h.replaceHash(p.getContacts("personal","","",1,"","create-contact"))},t.exports=new i},duUI:function(t,e,s){"use strict";var i=s("F/us"),o=s("EVdn"),n=(s("Ol7c"),s("AFLV")),r=s("tYdA");t.exports={callback:function(t,e,s,n,a){var l={Search:t.term,Storage:n,SortField:Enums.ContactSortField.Frequency,SortOrder:1,WithGroups:a||!1,WithoutTeamContactsDuplicates:!0};r.send("GetContacts",l,function(t){var n=[];t&&t.Result&&t.Result.List&&(n=i.map(t.Result.List,function(t){var e=t.ViewEmail,i="";return t.FullName&&0<o.trim(t.FullName).length&&(t.ForSharedToAll?e=t.FullName:t.IsGroup?(i='"'+t.FullName+'" ('+t.ViewEmail+")",e=t.ViewEmail):e='"'+t.FullName+'" <'+t.ViewEmail+">"),t&&t.ViewEmail&&t.ViewEmail!==s?{label:i||e,value:e,name:t.FullName,email:t.ViewEmail,frequency:t.Frequency,id:t.UUID,team:"team"===t.Storage,sharedToAll:"shared"===t.Storage}:null}),n=i.sortBy(i.compact(n),function(t){return-t.frequency})),e(n)})},phoneCallback:function(t,e){var s=o.trim(t.term),n={Search:s,SortField:Enums.ContactSortField.Frequency,SortOrder:1};""!==s&&r.send("GetContacts",n,function(t){var s=[];t&&t.Result&&t.Result.List&&(i.each(t.Result.List,function(t){i.each(t.Phones,function(e,i){s.push({label:""!==t.FullName?t.FullName+" <"+t.ViewEmail+"> "+e:t.ViewEmail+" "+e,value:e,frequency:t.Frequency})})}),s=i.sortBy(i.compact(s),function(t){return-t.frequency})),e(s)})},deleteHandler:function(t){r.send("UpdateContact",{Contact:{UUID:t.id,Frequency:-1}})},requestUserByPhone:function(t,e,s){oParameters={Search:t,SortField:Enums.ContactSortField.Frequency,SortOrder:1},r.send("GetContacts",oParameters,function(i){var r=i.Result,a="",l=n.isNonEmptyArray(r.List)?r.List[0]:null;l&&l.Phones&&o.each(l.Phones,function(e,s){var i=/[()\s_\-]/g;if(t.replace(i,"")===s.replace(i,""))return a=""===l.FullName?l.ViewEmail+" "+s:l.FullName+" "+s,!1}),e.call(s,a)})}}},fG7T:function(t,e,s){"use strict";var i=s("RN+F"),o=s("Ig+v");t.exports=new o(i.i18n("CONTACTSWEBCLIENT/ACTION_SHOW_CONTACTS"))},fIp0:function(t,e,s){"use strict";function i(t,e){this.bShown=!1,this.currentPage=r.observable(1),this.count=r.observable(t),this.perPage=r.observable(e),this.firstPage=r.observable(1),this.lastPage=r.observable(1),this.pagesCount=r.computed(function(){var t=this.perPage()>0?Math.ceil(this.count()/this.perPage()):0;return t>0?t:1},this),r.computed(function(){var t=20,e=4,s=this.pagesCount(),i=this.currentPage(),o=i,n=i;if(s>1)for(;t--,1<o&&(o--,e--),0!==e&&(s>n&&(n++,e--),0!==e)&&0!==t;);this.firstPage(o),this.lastPage(n)},this),this.visibleFirst=r.computed(function(){return this.firstPage()>1},this),this.visibleLast=r.computed(function(){return this.lastPage()<this.pagesCount()},this),this.clickPage=o.bind(this.clickPage,this),this.pages=r.computed(function(){var t=this.firstPage(),e=[];if(this.firstPage()<this.lastPage())for(;t<=this.lastPage();t++)e.push({number:t,current:t===this.currentPage(),clickFunc:this.clickPage});return e},this),l.isMobile()||this.hotKeysBind()}var o=s("F/us"),n=s("EVdn"),r=s("0h2I"),a=s("Yjhd"),l=s("IAk5");i.prototype.ViewTemplate="CoreWebclient_PageSwitcherView",i.prototype.hotKeysBind=function(){n(document).on("keydown",n.proxy(function(t){if(this.bShown&&!a.isTextFieldFocused()){var e=t.keyCode;t.ctrlKey&&e===Enums.Key.Left?this.clickPreviousPage():t.ctrlKey&&e===Enums.Key.Right&&this.clickNextPage()}},this))},i.prototype.hide=function(){this.bShown=!1},i.prototype.show=function(){this.bShown=!0},i.prototype.clear=function(){this.currentPage(1),this.count(0)},i.prototype.setCount=function(t){this.count(t),this.currentPage()>this.pagesCount()&&this.currentPage(this.pagesCount())},i.prototype.setPage=function(t,e){this.perPage(e),t>this.pagesCount()?this.currentPage(this.pagesCount()):this.currentPage(t)},i.prototype.clickPage=function(t){var e=t.number;e<1&&(e=1),e>this.pagesCount()&&(e=this.pagesCount()),this.currentPage(e)},i.prototype.clickFirstPage=function(){this.currentPage(1)},i.prototype.clickPreviousPage=function(){var t=this.currentPage()-1;t<1&&(t=1),this.currentPage(t)},i.prototype.clickNextPage=function(){var t=this.currentPage()+1;t>this.pagesCount()&&(t=this.pagesCount()),this.currentPage(t)},i.prototype.clickLastPage=function(){this.currentPage(this.pagesCount())},t.exports=i},hhaf:function(t,e,s){"use strict";var i=s("v6sP"),o={markVcardsExistentByFile:function(t){i.markVcardsExistentByFile(t)}};window.MainTabContactsMethods=o,t.exports={}},"kQb/":function(t,e,s){"use strict";function i(){this.bVisiblePersonalContacts=-1!==o.inArray("personal",r.Storages),this.bVisibleSharedWithAllContacts=-1!==o.inArray("shared",r.Storages),this.bVisibleTeamContacts=-1!==o.inArray("team",r.Storages),this.davPersonalContactsUrl=n.observable(""),this.davCollectedAddressesUrl=n.observable(""),this.davSharedWithAllUrl=n.observable(""),this.davTeamAddressBookUrl=n.observable("")}var o=s("EVdn"),n=s("0h2I"),r=s("+JH/");i.prototype.ViewTemplate="ContactsWebclient_MobileSyncSettingsView",i.prototype.populate=function(t){t.Contacts&&(this.davPersonalContactsUrl(t.Contacts.PersonalContactsUrl),this.davCollectedAddressesUrl(t.Contacts.CollectedAddressesUrl),this.davSharedWithAllUrl(t.Contacts.SharedWithAllUrl),this.davTeamAddressBookUrl(t.Contacts.TeamAddressBookUrl))},t.exports=new i},kwPS:function(t,e,s){"use strict";function i(t,e,s,i,l,c,u,p,d,m,f){this.fSelectCallback=e||function(){},this.fDeleteCallback=s||function(){},this.fDblClickCallback=!h.isMobile()&&i?i:function(){},this.fEnterCallback=l||function(){},this.bResetCheckedOnClick=!!u,this.bCheckOnSelect=!!p,this.bUnselectOnCtrl=!!d,this.bDisableMultiplySelection=!!m,this.bChangeOnSelect=void 0===f||!!f,this.useKeyboardKeys=r.observable(!1),this.list=r.observableArray([]),t&&t.subscribe&&t.subscribe(function(t){this.list(t)},this),this.multiplyLineFactor=c,this.oLast=null,this.oListScope=null,this.oScrollScope=null,this.iTimer=0,this.iFactor=1,this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Up,this.KeyRight=Enums.Key.Down,this.multiplyLineFactor&&(this.multiplyLineFactor.subscribe?this.multiplyLineFactor.subscribe(function(t){this.iFactor=0<t?t:1},this):this.iFactor=a.pInt(this.multiplyLineFactor),this.KeyUp=Enums.Key.Up,this.KeyDown=Enums.Key.Down,this.KeyLeft=Enums.Key.Left,this.KeyRight=Enums.Key.Right,n("html").hasClass("rtl")&&(this.KeyLeft=Enums.Key.Right,this.KeyRight=Enums.Key.Left)),this.sActionSelector="",this.sSelectabelSelector="",this.sCheckboxSelector="";var b=this;this.listChecked=r.computed({read:function(){return o.filter(this.list(),function(t){var e=t.checked(),s=t.selected();return e||b.bCheckOnSelect&&s})},write:function(t){t=!!t,o.each(this.list(),function(e){e.checked(t)}),this.list.valueHasMutated()},owner:this}),this.checkAll=r.computed({read:function(){return 0<this.listChecked().length},write:function(t){this.listChecked(!!t)},owner:this}),this.selectorHook=r.observable(null),this.selectorHook.subscribe(function(){var t=this.selectorHook();t&&o.isFunction(t.selected)&&t.selected(!1)},this,"beforeChange"),this.selectorHook.subscribe(function(t){t&&t.selected(!0)},this),this.itemSelected=r.computed({read:this.selectorHook,write:function(t){this.selectorHook(t),t&&(b.scrollToSelected(),this.oLast=t)},owner:this}),this.list.subscribe(function(t){if(o.isArray(t)){var e=this.itemSelected();e&&(o.find(t,function(t){return e===t})||this.itemSelected(null))}else this.itemSelected(null)},this),this.listCheckedOrSelected=r.computed({read:function(){var t=this.itemSelected(),e=this.listChecked();return 0<e.length?e:t?[t]:[]},write:function(t){t?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.listCheckedAndSelected=r.computed({read:function(){var t=[],e=this.itemSelected(),s=this.listChecked();return s&&(t=s.slice(0)),e&&-1===o.indexOf(s,e)&&t.push(e),t},write:function(t){t?this.listChecked(!0):(this.itemSelected(null),this.listChecked(!1))},owner:this}),this.isIncompleteChecked=r.computed(function(){var t=this.list().length,e=this.listChecked().length;return 0<t&&0<e&&t>e},this),this.onKeydownBound=o.bind(this.onKeydown,this)}var o=s("F/us"),n=s("EVdn"),r=s("0h2I"),a=s("AFLV"),l=s("Yjhd"),h=s("IAk5"),c=s("HLSX"),u=s("76Kh");i.prototype.iTimer=0,i.prototype.bResetCheckedOnClick=!1,i.prototype.bCheckOnSelect=!1,i.prototype.bUnselectOnCtrl=!1,i.prototype.bDisableMultiplySelection=!1,i.prototype.getLastOrSelected=function(){var t=0,e=null;return o.each(this.list(),function(s){s.checked()&&t++,s.selected()&&(e=s)}),0===t&&e?e:this.oLast},i.prototype.initOnApplyBindings=function(t,e,s,i,o){n(document).on("keydown",this.onKeydownBound),this.oListScope=i,this.oScrollScope=o,this.sActionSelector=t,this.sSelectabelSelector=e,this.sCheckboxSelector=s;var a=this,l=function(t,e,s){var i=0,o=0,n=null,r=!1,l=!1,h=[],c=!1;if(e=e||null,s&&s.shiftKey&&null!==e&&null!==t&&e!==t)for(h=a.list(),c=e.checked(),i=0,o=h.length;i<o;i++)r=!1,(n=h[i])!==t&&n!==e||(r=!0),r&&(l=!l),(l||r)&&n.checked(c);e&&(a.oLast=e)};n(this.oListScope).on("dblclick",t,function(t){var e=r.dataFor(this);!e||!t||t.ctrlKey||t.altKey||t.shiftKey||a.onDblClick(e)}),c.mobileDevice&&n(this.oListScope).on("touchstart",t,function(t){if(t){var e=t.timeStamp,s=e-(n(this).data("lastTouch")||e),i=t.originalEvent&&t.originalEvent.touches?t.originalEvent.touches.length:0;n(this).data("lastTouch",e),!s||s>250||i>1||(t.preventDefault(),n(this).trigger("dblclick"))}}),n(this.oListScope).on("click",t,function(t){var e=!0,s=null,i=a.getLastOrSelected(),o=r.dataFor(this);o&&t&&(t.shiftKey?(e=!1,a.bDisableMultiplySelection||(null===a.oLast&&(a.oLast=o),o.checked(!o.checked()),l(i,o,t))):t.ctrlKey&&(e=!1,a.bDisableMultiplySelection||(a.oLast=o,!(s=a.itemSelected())||s.checked()||o.checked()||s.checked(!0),a.bUnselectOnCtrl&&o===a.itemSelected()?(o.checked(!o.selected()),a.itemSelected(null)):o.checked(!o.checked()))),e&&a.selectionFunc(o))}),n(this.oListScope).on("click",s,function(t){var e=r.dataFor(this);e&&t&&!a.bDisableMultiplySelection&&(t.shiftKey?(null===a.oLast&&(a.oLast=e),l(a.getLastOrSelected(),e,t)):a.oLast=e),t&&t.stopPropagation&&t.stopPropagation()}),n(this.oListScope).on("dblclick",s,function(t){t&&t.stopPropagation&&t.stopPropagation()})},i.prototype.getResultSelection=function(t,e){var s=this,i=!1,r=!1,a=null,l=this.iFactor,h=!!this.multiplyLineFactor,c=0,u=0,p=[];if(!t&&-1<n.inArray(e,[this.KeyUp,this.KeyDown,this.KeyLeft,this.KeyRight,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]))(p=this.list())&&0<p.length&&(-1<n.inArray(e,[this.KeyDown,this.KeyRight,Enums.Key.PageUp,Enums.Key.Home])?a=p[0]:-1<n.inArray(e,[this.KeyUp,this.KeyLeft,Enums.Key.PageDown,Enums.Key.End])&&(a=p[p.length-1]));else if(t&&(p=this.list(),0<(u=p?p.length:0)))if(Enums.Key.Home===e||Enums.Key.PageUp===e||Enums.Key.End===e||Enums.Key.PageDown===e||h&&(Enums.Key.Left===e||Enums.Key.Right===e)||!h&&(Enums.Key.Up===e||Enums.Key.Down===e))o.each(p,function(o){if(!i)switch(e){case s.KeyUp:case s.KeyLeft:t===o?i=!0:a=o;break;case Enums.Key.Home:case Enums.Key.PageUp:a=o,i=!0;break;case s.KeyDown:case s.KeyRight:r?(a=o,i=!0):t===o&&(r=!0);break;case Enums.Key.End:case Enums.Key.PageDown:a=o}});else if(h&&this.KeyDown===e){for(;c<u;c++)if(t===p[c]){u-1<(c+=l)&&(c-=l),a=p[c];break}}else if(h&&this.KeyUp===e)for(c=u;c>=0;c--)if(t===p[c]){0>(c-=l)&&(c+=l),a=p[c];break}return a},i.prototype.shiftClickResult=function(t,e,s){if(e){var i=!!this.multiplyLineFactor,r=!1,a=!1;-1<n.inArray(s,i?[Enums.Key.Left,Enums.Key.Right]:[Enums.Key.Up,Enums.Key.Down])?e.checked(!e.checked()):-1<n.inArray(s,i?[Enums.Key.Up,Enums.Key.Down,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End]:[Enums.Key.Left,Enums.Key.Right,Enums.Key.PageUp,Enums.Key.PageDown,Enums.Key.Home,Enums.Key.End])&&(a=!e.checked(),o.each(this.list(),function(s){var i=!1;s!==t&&e!==s||(r=!r,i=!0),(r||i)&&(s.checked(a),i=!1)}),i&&t&&(s===Enums.Key.Up||s===Enums.Key.Down)&&t.checked(!t.checked()))}},i.prototype.clickNewSelectPosition=function(t,e){var s=this.itemSelected(),i=this.getResultSelection(s,t);i&&(e&&this.shiftClickResult(i,s,t),this.selectionFunc(i))},i.prototype.onKeydown=function(t){var e=!0,s=0;return this.useKeyboardKeys()&&t&&!l.isTextFieldFocused()&&!u.hasOpenedMaximizedPopups()&&(s=t.keyCode,t.ctrlKey||this.KeyUp!==s&&this.KeyDown!==s&&this.KeyLeft!==s&&this.KeyRight!==s&&Enums.Key.PageUp!==s&&Enums.Key.PageDown!==s&&Enums.Key.Home!==s&&Enums.Key.End!==s?Enums.Key.Del!==s||t.ctrlKey||t.shiftKey?Enums.Key.Enter===s?0<this.list().length&&!t.ctrlKey&&(this.onEnter(this.itemSelected()),e=!1):!t.ctrlKey||t.altKey||t.shiftKey||Enums.Key.a!==s||(this.checkAll(!(this.checkAll()&&!this.isIncompleteChecked())),e=!1):0<this.list().length&&(this.onDelete(),e=!1):(this.clickNewSelectPosition(s,t.shiftKey),e=!1)),e},i.prototype.onDelete=function(){this.fDeleteCallback.call(this,this.listCheckedOrSelected())},i.prototype.onEnter=function(t){this.fEnterCallback.call(this,t)},i.prototype.selectionFunc=function(t){this.bChangeOnSelect&&this.itemSelected(null),this.bResetCheckedOnClick&&this.listChecked(!1),this.bChangeOnSelect&&this.itemSelected(t),this.fSelectCallback.call(this,t)},i.prototype.onDblClick=function(t){this.fDblClickCallback.call(this,t)},i.prototype.koCheckAll=function(){return r.computed({read:this.checkAll,write:this.checkAll,owner:this})},i.prototype.koCheckAllIncomplete=function(){return r.computed({read:this.isIncompleteChecked,write:this.isIncompleteChecked,owner:this})},i.prototype.scrollToSelected=function(){if(!this.oListScope||!this.oScrollScope)return!1;var t=n(this.sSelectabelSelector,this.oScrollScope),e=t.position(),s=this.oScrollScope.height(),i=t.outerHeight();return!(!e||!(e.top<0||e.top+i>s))&&(e.top<0?this.oScrollScope.scrollTop(this.oScrollScope.scrollTop()+e.top-20):this.oScrollScope.scrollTop(this.oScrollScope.scrollTop()+e.top-s+i+20),!0)},t.exports=i},mjrp:function(t,e,s){"use strict";function i(t){return void 0===t}function o(t){0<t&&clearTimeout(t),t=0}function n(t){return(t=t&&(t.originalEvent?t.originalEvent:t)||window.event).dataTransfer?t:null}function r(t,e,s){return t&&e&&!i(t[e])?t[e]:s}function a(t,e,s){t[e]=s}function l(){return"jua-uid-"+function(t){var e="",s="0123456789abcdefghijklmnopqrstuvwxyz";for(t=i(t)?32:A.pInt(t);e.length<t;)e+=s.substr(Math.round(Math.random()*s.length),1);return e}(16)+"-"+(new Date).getTime().toString()}function h(t,e){return{FileName:i(t.fileName)?i(t.name)?null:t.name:t.fileName,Size:i(t.fileSize)?i(t.size)?null:t.size:t.fileSize,Type:i(t.type)?null:t.type,Folder:i(e)?"":e,File:t}}function c(t,e,s,o,n,r){var a=0,l=0,c=0,u=null,p=null,d=!1,m=!1,f=function(t,e,s,l){if(t&&!i(t.name))if(e=e||"",t.isFile)t.file(function(t){!d||0<=--n?s(h(t,e)):d&&!m&&0>n&&r&&(m=!0,r(a))});else if(o&&t.isDirectory&&t.createReader){var c=t.createReader(),u=0,p=0;c&&c.readEntries&&c.readEntries(function(i){if(i&&A.isNonEmptyArray(i))for(u=0,p=i.length;u<p;u++)f(i[u],e+t.name+"/",s,l)})}};if(o=!!i(o)||!!o,s=!i(s)&&!!s,n=i(n)?T:A.pInt(n),a=n,d=0<n,t=t&&0<t.length?t:null)for(c=0,l=t.length;c<l;c++)(u=t[c])&&(s?"file"===u.kind&&u.webkitGetAsEntry&&(p=u.webkitGetAsEntry())&&f(p,"",e,r):!d||0<=--n?e(h(u)):d&&!m&&0>n&&r&&(m=!0,r(a)))}function u(t,e,s,i){var o=t&&t.files&&0<t.files.length?t.files:null;o?c(o,e,!1,!1,s,i):e({FileName:t.value.split("\\").pop().split("/").pop(),Size:null,Type:null,Folder:"",File:null})}function p(t){var e=!1;if(t&&t.dataTransfer&&t.dataTransfer.types&&t.dataTransfer.types.length)for(var s=0,i=t.dataTransfer.types.length;s<i;s++)if("files"===t.dataTransfer.types[s].toLowerCase()){e=!0;break}return e}function d(){return g('<label style="position: absolute; background-color:#fff; right: 0px; top: 0px; left: 0px; bottom: 0px; margin: 0px; padding: 0px; cursor: pointer;"></label>').css({opacity:0})}function m(t,e,s,o){t=i(t)?"":t.toString();var n=function(t,e){return""!==e&&(e=' accept="'+e+'"'),g('<input type="file" tabindex="-1" hidefocus="hidefocus" style="position: absolute; '+t+': -9999px;"'+e+" />")}(s=i(s)?"left":s.toString(),o=i(o)?"":o.toString());return 0<t.length&&n.attr("name",t),(i(e)||e)&&n.prop("multiple",!0),n}function f(t,e){return A.pString(E.isFunction(t)?t.apply(null,E.isArray(e)?e:[]):t)}function b(t,e){this.oXhrs={},this.oUids={},this.oJua=t,this.oOptions=e}function C(t,e){this.oUids={},this.oForms={},this.oJua=t,this.oOptions=e}function y(t){t=i(t)?{}:t;var e=this;e.bEnableDnD=!0,e.bEnableButton=!0,e.oEvents={onDialog:null,onSelect:null,onStart:null,onComplete:null,onCompleteAll:null,onProgress:null,onDragEnter:null,onDragLeave:null,onDrop:null,onBodyDragEnter:null,onBodyDragLeave:null,onLimitReached:null},e.oOptions=E.extend({action:"",name:"",hidden:{},queueSize:10,clickElement:!1,dragAndDropElement:!1,dragAndDropBodyElement:!1,disableAjaxUpload:!1,disableFolderDragAndDrop:!0,disableDragAndDrop:!1,disableMultiple:!1,disableDocumentDropPrevent:!1,disableAutoUploadOnDrop:!1,multipleSizeLimit:50,hiddenElementsPosition:"left"},t),e.oQueue=v(A.pInt(r(e.oOptions,"queueSize",10))),e.runEvent("onCompleteAll")&&e.oQueue.await(function(){e.runEvent("onCompleteAll")}),e.oDriver=e.isAjaxUploaderSupported()&&!r(e.oOptions,"disableAjaxUpload",!1)?new b(e,e.oOptions):new C(e,e.oOptions),e.oClickElement=r(e.oOptions,"clickElement",null),e.oClickElement&&(g(e.oClickElement).css({position:"relative",overflow:"hidden"}),"inline"===g(this.oClickElement).css("display")&&g(this.oClickElement).css("display","inline-block"),this.oDriver.generateNewInput(this.oClickElement)),this.oDriver.isDragAndDropSupported()&&r(this.oOptions,"dragAndDropElement",!1)&&!r(this.oOptions,"disableAjaxUpload",!1)?function(t){var e=g(document),s=g(r(t.oOptions,"dragAndDropBodyElement",!1)||e),i=r(t.oOptions,"dragAndDropElement",!1);i&&(r(t.oOptions,"disableDocumentDropPrevent",!1)||e.on("dragover",function(e){if(t.bEnableDnD&&e&&(e=n(e))&&e.dataTransfer&&p(e))try{e.dataTransfer.dropEffect="none",e.preventDefault()}catch(t){}}),s&&s[0]&&s.on("dragover",function(e){t.bEnableDnD&&e&&o(t.iDocTimer)}).on("dragenter",function(e){t.bEnableDnD&&e&&(e=n(e))&&p(e)&&(o(t.iDocTimer),e.preventDefault(),t.runEvent("onBodyDragEnter",[e]))}).on("dragleave",function(e){t.bEnableDnD&&e&&(e=n(e))&&(o(t.iDocTimer),t.iDocTimer=setTimeout(function(){t.runEvent("onBodyDragLeave",[e])},200))}).on("drop",function(e){if(t.bEnableDnD&&e&&(e=n(e))){var s=p(e);return s&&e.preventDefault(),t.runEvent("onBodyDragLeave",[e]),!s}return!1}),g(i).bind("dragenter",function(e){t.bEnableDnD&&e&&(e=n(e))&&p(e)&&(o(t.iDocTimer),e.preventDefault(),t.runEvent("onDragEnter",[i,e]))}).bind("dragover",function(e){if(t.bEnableDnD&&e&&(e=n(e))&&e.dataTransfer&&p(e))try{var i=e.dataTransfer.effectAllowed;o(t.iDocTimer),e.dataTransfer.dropEffect="move"===i||"linkMove"===i?"move":"copy",e.stopPropagation(),e.preventDefault(),s.trigger("dragover",e)}catch(t){}}).bind("dragleave",function(e){if(t.bEnableDnD&&e&&(e=n(e))){var s=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;if(s&&function(t,e){var s=!1;return t&&e&&(s=t===e||(t.contains?t.contains(e):!!e.compareDocumentPosition&&!!(8&e.compareDocumentPosition(t)))),s}(this,s))return;o(t.iDocTimer),t.runEvent("onDragLeave",[i,e])}}).bind("drop",function(e){t.bEnableDnD&&e&&(e=n(e))&&p(e)&&(e.preventDefault(),function(t,e,s,i,o){var a=null,l=null;(t=n(t))&&((a=(t.dataTransfer?r(t.dataTransfer,"items",null):null)||r(t,"items",null))&&0<a.length&&a[0]&&a[0].webkitGetAsEntry?c(a,e,!0,o,s,i):p(t)&&(l=r(t,"files",null)||(t.dataTransfer?r(t.dataTransfer,"files",null):null))&&0<l.length&&c(l,e,!1,!1,s,i))}(e,function(s){s&&(r(t.oOptions,"disableAutoUploadOnDrop",!1)?t.runEvent("onDrop",[s,e,function(){t.addNewFile(s),o(t.iDocTimer)}]):(t.runEvent("onDrop",[s,e]),t.addNewFile(s),o(t.iDocTimer)))},r(t.oOptions,"multipleSizeLimit",T),t.getEvent("onLimitReached"),!r(t.oOptions,"disableFolderDragAndDrop",!0))),t.runEvent("onDragLeave",[e])}))}(e):e.bEnableDnD=!1,a(e,"on",e.on),a(e,"cancel",e.cancel),a(e,"isDragAndDropSupported",e.isDragAndDropSupported),a(e,"isAjaxUploaderSupported",e.isAjaxUploaderSupported),a(e,"setDragAndDropEnabledStatus",e.setDragAndDropEnabledStatus)}var g=s("EVdn"),E=s("F/us"),S=s("0h2I"),v=s("w+bY"),A=s("AFLV"),P=s("IAk5"),T=20;b.prototype.oXhrs={},b.prototype.oUids={},b.prototype.oJua=null,b.prototype.oOptions={},b.prototype.isDragAndDropSupported=function(){return!0},b.prototype.regTaskUid=function(t){this.oUids[t]=!0},b.prototype.uploadTask=function(t,e,s,o,n,a,l){if(!1===this.oUids[t]||!e||!e.File)return o(null,t),!1;try{var h=this,c=new XMLHttpRequest,u=new FormData,p=r(this.oOptions,"action",""),d=E.clone(r(this.oOptions,"hidden",{})),m=this.oJua.getEvent("onStart"),b=this.oJua.getEvent("onComplete"),C=this.oJua.getEvent("onProgress");return c.open("POST",p,!0),c.setRequestHeader("Authorization","Bearer "+g.cookie("AuthToken")),c.setRequestHeader("X-Client","WebClient"),C&&c.upload&&(c.upload.onprogress=function(s){s&&s.lengthComputable&&!i(s.loaded)&&!i(s.total)&&(void 0===l?C(t,s.loaded,s.total):C(t,l+s.loaded>e.Size?e.Size:l+s.loaded,e.Size))}),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){if(b&&!n){var e=!1,s=null;try{s=g.parseJSON(c.responseText),e=!0}catch(t){s=null}b(t,e,s)}i(h.oXhrs[t])||(h.oXhrs[t]=null),a?o(c.responseText,t):o(null,t)}else 4===c.readyState&&(b(t,!1,null),o(null,t))},m&&m(t),u.append("jua-post-type","ajax"),u.append(r(this.oOptions,"name","juaFile"),e.File,e.FileName),s=E.extend(s,e.Hidden||{}),d.Parameters=JSON.stringify(s),g.each(d,function(t,s){u.append(t,f(s,[e]))}),c.send(u),this.oXhrs[t]=c,!0}catch(t){window.console&&window.console.error(t)}return o(null,t),!1},b.prototype.generateNewInput=function(t){var e=this,s=null,i=null;t&&(i=m("",!r(this.oOptions,"disableMultiple",!1),r(this.oOptions,"hiddenElementsPosition","left"),r(this.oOptions,"accept","")),(s=d()).append(i),g(t).append(s),i.on("click",function(t){if(e.oJua.bEnableButton){var s=e.oJua.getEvent("onDialog");s&&s()}else t.preventDefault()}).on("change",function(){u(this,function(i){e.oJua.addNewFile(i),e.generateNewInput(t),setTimeout(function(){s.remove()},10)},r(e.oOptions,"multipleSizeLimit",T),e.oJua.getEvent("onLimitReached"))}))},b.prototype.cancel=function(t){if(this.oUids[t]=!1,this.oXhrs[t]){try{this.oXhrs[t].abort&&this.oXhrs[t].abort()}catch(t){}this.oXhrs[t]=null}},C.prototype.oUids={},C.prototype.oForms={},C.prototype.oJua=null,C.prototype.oOptions={},C.prototype.isDragAndDropSupported=function(){return!1},C.prototype.regTaskUid=function(t){this.oUids[t]=!0},C.prototype.uploadTask=function(t,e,s,i,o,n,a){if(!1===this.oUids[t])return i(null,t),!1;var l=this.oForms[t],h=E.clone(r(this.oOptions,"hidden",{})),c=this.oJua.getEvent("onStart"),u=this.oJua.getEvent("onComplete");return l?(l.append(g('<input type="hidden" />').attr("name","jua-post-type").val("iframe")),s=E.extend(s,e.Hidden||{}),h.Parameters=JSON.stringify(s),g.each(h,function(t,s){l.append(g('<input type="hidden" />').attr("name",t).val(f(s,[e])))}),l.trigger("submit"),c&&c(t),l.find("iframe").on("load",function(e){var s=!1,o=null,n={};if(u){try{o=this.contentDocument?this.contentDocument:this.contentWindow.document,n=g.parseJSON(o.body.innerHTML),s=!0}catch(t){n={}}u(t,s,n)}i(null,t),window.setTimeout(function(){l.remove()},100)})):i(null,t),!0},C.prototype.generateNewInput=function(t){var e=this,s="",i=null,o=null,n=r(this.oOptions,"action",""),a=null,h=r(this.oOptions,"hiddenElementsPosition","left");t&&(s=l(),i=m(r(this.oOptions,"name","juaFile"),!r(this.oOptions,"disableMultiple",!1),r(this.oOptions,"hiddenElementsPosition","left"),r(this.oOptions,"accept","")),a=g('<form action="'+n+'" target="iframe-'+s+'"  method="POST" enctype="multipart/form-data" style="display: block; cursor: pointer;"></form>'),o=g('<iframe name="iframe-'+s+'" tabindex="-1" src="javascript:void(0);"  style="position: absolute; top: -1000px; '+h+': -1000px; cursor: pointer;" />').css({opacity:0}),a.append(d().append(i)).append(o),g(t).append(a),this.oForms[s]=a,i.on("click",function(t){if(e.oJua.bEnableButton){var s=e.oJua.getEvent("onDialog");s&&s()}else t.preventDefault()}).on("change",function(){u(this,function(i){if(i){var o=r(e.oOptions,"hiddenElementsPosition","left");a.css({position:"absolute",top:-1e3}),a.css(o,-1e3),e.oJua.addFile(s,i),e.generateNewInput(t)}},r(e.oOptions,"multipleSizeLimit",T),e.oJua.getEvent("onLimitReached"))}))},C.prototype.cancel=function(t){this.oUids[t]=!1,this.oForms[t]&&(this.oForms[t].remove(),this.oForms[t]=!1)},y.prototype.bEnableDnD=!0,y.prototype.iDocTimer=0,y.prototype.oOptions={},y.prototype.oEvents={},y.prototype.oQueue=null,y.prototype.oDriver=null,y.prototype.on=function(t,e){return this.oEvents[t]=e,this},y.prototype.runEvent=function(t,e){this.oEvents[t]&&this.oEvents[t].apply(null,e||[])},y.prototype.getEvent=function(t){return this.oEvents[t]||null},y.prototype.cancel=function(t){this.oDriver.cancel(t)},y.prototype.isAjaxUploaderSupported=function(){return function(){var t=document.createElement("input");return t.type="file",!!("XMLHttpRequest"in window&&"multiple"in t&&"FormData"in window&&(new XMLHttpRequest).upload)}()},y.prototype.setDragAndDropEnabledStatus=function(t){this.bEnableDnD=!!t},y.prototype.isDragAndDropSupported=function(){return this.oDriver.isDragAndDropSupported()},y.prototype.addNewFile=function(t){this.addFile(l(),t)},y.prototype.addFile=function(t,e){var s=this.getEvent("onSelect"),o=null,n=r(this.oOptions,"hidden",{}),a=this.getEvent("onComplete"),l=E.bind(function(t,e){var s=r(this.oOptions,"hidden",{}),o=JSON.parse(f(s.Parameters,[e]));this.oDriver.regTaskUid(t),this.oQueue.defer(function(t,e){return function(){return t.apply(i(e)?null:e,Array.prototype.slice.call(arguments))}}(this.oDriver.uploadTask,this.oDriver),t,e,o)},this),h=this.getEvent("onCancel");if(!e||s&&!1===s(t,e))this.oDriver.cancel(t);else{o=E.bind(function(t,e,s,i,n,l){var h=null;h=function(e,i){var n=null;try{n=g.parseJSON(e)}catch(t){}n&&n.Result&&!n.Result.Error&&!n.ErrorCode?s(t,o):n&&n.Result&&n.Result.Error?(P.broadcastEvent("Jua::FileUploadingError"),a(i,!1,{ErrorCode:n.Result.Error})):n&&n.ErrorCode?(P.broadcastEvent("Jua::FileUploadingError"),a(i,!1,{ErrorCode:n.ErrorCode})):(P.broadcastEvent("Jua::FileUploadingError"),a(i,!1))};var c=r(this.oOptions,"hidden",{}),u=JSON.parse(f(c.Parameters,[e]));this.oDriver.regTaskUid(t),this.oDriver.uploadTask(t,e,u,h,i<n,!0,l)},this);var c=S.observable(!0),u=JSON.parse(f(n.Parameters,[e]));P.broadcastEvent("Jua::FileUpload::isUploadAvailable",{isUploadAvailable:c,sModuleName:n.Module,sUid:t,oFileInfo:e}),c()?!1===P.broadcastEvent("Jua::FileUpload::before",{sUid:t,oFileInfo:e,fOnChunkReadyCallback:o,sModuleName:n.Module,fRegularUploadFileCallback:l,fCancelFunction:h,sStorageType:u.Type})&&l(t,e):E.isFunction(h)&&h(t)}},y.prototype.setOption=function(t,e){this.oOptions[t]=e},t.exports=y},nKlx:function(t,e,s){"use strict";var i=s("RN+F"),o={};o.getMonthNamesArray=function(){for(var t=i.i18n("COREWEBCLIENT/LIST_MONTH_NAMES").split(" "),e=t.length;e<12;e++)t[e]="";return t},o.daysInMonth=function(t,e){return 0<t&&13>t&&0<e?new Date(e,t,0).getDate():31},t.exports=o},tYdA:function(t,e,s){"use strict";var i=s("o0Bx"),o=s("+JH/");i.registerAbortRequestHandler(o.ServerModuleName,function(t,e){switch(t.Method){case"GetContacts":return"GetContacts"===e.Method;case"GetContact":return"GetContact"===e.Method}return!1}),t.exports={send:function(t,e,s,n,r){i.send(o.ServerModuleName,t,e,s,n,void 0,r)}}},tgQO:function(t,e,s){"use strict";function i(){this.sEmailDefaultType=Enums.ContactsPrimaryEmail.Personal,this.sPhoneDefaultType=Enums.ContactsPrimaryPhone.Mobile,this.sAddressDefaultType=Enums.ContactsPrimaryAddress.Personal,this.uuid=r.observable(""),this.idUser=r.observable(""),this.team=r.observable(!1),this.itsMe=r.observable(!1),this.storage=r.observable("personal"),this.isNew=r.observable(!1),this.readOnly=r.observable(!1),this.edited=r.observable(!1),this.extented=r.observable(!1),this.personalCollapsed=r.observable(!1),this.businessCollapsed=r.observable(!1),this.otherCollapsed=r.observable(!1),this.groupsCollapsed=r.observable(!1),this.displayName=r.observable(""),this.firstName=r.observable(""),this.lastName=r.observable(""),this.nickName=r.observable(""),this.skype=r.observable(""),this.facebook=r.observable(""),this.displayNameFocused=r.observable(!1),this.primaryEmail=r.observable(this.sEmailDefaultType),this.primaryPhone=r.observable(this.sPhoneDefaultType),this.primaryAddress=r.observable(this.sAddressDefaultType),this.mainPrimaryEmail=r.computed({read:this.primaryEmail,write:function(t){t&&0<=n.inArray(t,[Enums.ContactsPrimaryEmail.Personal,Enums.ContactsPrimaryEmail.Business,Enums.ContactsPrimaryEmail.Other])?this.primaryEmail(t):this.primaryEmail(Enums.ContactsPrimaryEmail.Personal)},owner:this}),this.mainPrimaryPhone=r.computed({read:this.primaryPhone,write:function(t){t&&0<=n.inArray(t,[Enums.ContactsPrimaryPhone.Mobile,Enums.ContactsPrimaryPhone.Personal,Enums.ContactsPrimaryPhone.Business])?this.primaryPhone(t):this.primaryPhone(Enums.ContactsPrimaryPhone.Mobile)},owner:this}),this.mainPrimaryAddress=r.computed({read:this.primaryAddress,write:function(t){t&&0<=n.inArray(t,[Enums.ContactsPrimaryAddress.Personal,Enums.ContactsPrimaryAddress.Business])?this.primaryAddress(t):this.primaryAddress(Enums.ContactsPrimaryAddress.Personal)},owner:this}),this.personalEmail=r.observable(""),this.personalStreetAddress=r.observable(""),this.personalCity=r.observable(""),this.personalState=r.observable(""),this.personalZipCode=r.observable(""),this.personalCountry=r.observable(""),this.personalWeb=r.observable(""),this.personalFax=r.observable(""),this.personalPhone=r.observable(""),this.personalMobile=r.observable(""),this.businessEmail=r.observable(""),this.businessCompany=r.observable(""),this.businessDepartment=r.observable(""),this.businessJob=r.observable(""),this.businessOffice=r.observable(""),this.businessStreetAddress=r.observable(""),this.businessCity=r.observable(""),this.businessState=r.observable(""),this.businessZipCode=r.observable(""),this.businessCountry=r.observable(""),this.businessWeb=r.observable(""),this.businessFax=r.observable(""),this.businessPhone=r.observable(""),this.otherEmail=r.observable(""),this.otherBirthMonth=r.observable(0),this.otherBirthDay=r.observable(0),this.otherBirthYear=r.observable(0),this.otherNotes=r.observable(""),this.etag=r.observable(""),this.sharedToAll=r.observable(!1),this.birthdayIsEmpty=r.computed(function(){var t=0===this.otherBirthMonth(),e=0===this.otherBirthDay(),s=0===this.otherBirthYear();return t||e||s},this),this.otherBirthday=r.computed(function(){var t="",e=this.otherBirthYear(),s=this.otherBirthMonth(),i=this.otherBirthDay(),o=new f;if(!this.birthdayIsEmpty()){var n=a().diff(a(e+"/"+s+"/"+i,"YYYY/MM/DD"),"years"),r=c.i18n("CONTACTSWEBCLIENT/LABEL_YEARS_PLURAL",{COUNT:n},null,n);o.setDate(e,0<s?s-1:0,i),t=o.getShortDate()+" ("+r+")"}return t},this),this.groups=r.observableArray([]),this.groupsIsEmpty=r.computed(function(){return 0===this.groups().length},this),this.email=r.computed({read:function(){var t="";switch(this.primaryEmail()){case Enums.ContactsPrimaryEmail.Personal:t=this.personalEmail();break;case Enums.ContactsPrimaryEmail.Business:t=this.businessEmail();break;case Enums.ContactsPrimaryEmail.Other:t=this.otherEmail()}return t},write:function(t){switch(this.primaryEmail()){case Enums.ContactsPrimaryEmail.Personal:this.personalEmail(t);break;case Enums.ContactsPrimaryEmail.Business:this.businessEmail(t);break;case Enums.ContactsPrimaryEmail.Other:this.otherEmail(t);break;default:this.primaryEmail(this.sEmailDefaultType),this.email(t)}},owner:this}),this.personalIsEmpty=r.computed(function(){return""==""+(this.personalEmail()!==this.email()?this.personalEmail():"")+this.personalStreetAddress()+this.personalCity()+this.personalState()+this.personalZipCode()+this.personalCountry()+this.personalWeb()+this.personalFax()+this.personalPhone()+this.personalMobile()},this),this.businessIsEmpty=r.computed(function(){return""==""+(this.businessEmail()!==this.email()?this.businessEmail():"")+this.businessCompany()+this.businessDepartment()+this.businessJob()+this.businessOffice()+this.businessStreetAddress()+this.businessCity()+this.businessState()+this.businessZipCode()+this.businessCountry()+this.businessWeb()+this.businessFax()+this.businessPhone()},this),this.otherIsEmpty=r.computed(function(){return""==""+(this.otherEmail()!==this.email()?this.otherEmail():"")+this.otherNotes()&&this.birthdayIsEmpty()},this),this.phone=r.computed({read:function(){var t="";switch(this.primaryPhone()){case Enums.ContactsPrimaryPhone.Mobile:t=this.personalMobile();break;case Enums.ContactsPrimaryPhone.Personal:t=this.personalPhone();break;case Enums.ContactsPrimaryPhone.Business:t=this.businessPhone()}return t},write:function(t){switch(this.primaryPhone()){case Enums.ContactsPrimaryPhone.Mobile:this.personalMobile(t);break;case Enums.ContactsPrimaryPhone.Personal:this.personalPhone(t);break;case Enums.ContactsPrimaryPhone.Business:this.businessPhone(t);break;default:this.primaryPhone(this.sEmailDefaultType),this.phone(t)}},owner:this}),this.address=r.computed({read:function(){var t="";switch(this.primaryAddress()){case Enums.ContactsPrimaryAddress.Personal:t=this.personalStreetAddress();break;case Enums.ContactsPrimaryAddress.Business:t=this.businessStreetAddress()}return t},write:function(t){switch(this.primaryAddress()){case Enums.ContactsPrimaryAddress.Personal:this.personalStreetAddress(t);break;case Enums.ContactsPrimaryAddress.Business:this.businessStreetAddress(t);break;default:this.primaryAddress(this.sEmailDefaultType),this.address(t)}},owner:this}),this.emails=r.computed(function(){var t=[];return""!==this.personalEmail()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_PERSONAL")+": "+this.personalEmail(),value:Enums.ContactsPrimaryEmail.Personal}),""!==this.businessEmail()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_BUSINESS")+": "+this.businessEmail(),value:Enums.ContactsPrimaryEmail.Business}),""!==this.otherEmail()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_OTHER")+": "+this.otherEmail(),value:Enums.ContactsPrimaryEmail.Other}),t},this),this.phones=r.computed(function(){var t=[];return""!==this.personalMobile()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_MOBILE")+": "+this.personalMobile(),value:Enums.ContactsPrimaryPhone.Mobile}),""!==this.personalPhone()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_PERSONAL")+": "+this.personalPhone(),value:Enums.ContactsPrimaryPhone.Personal}),""!==this.businessPhone()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_BUSINESS")+": "+this.businessPhone(),value:Enums.ContactsPrimaryPhone.Business}),t},this),this.addresses=r.computed(function(){var t=[];return""!==this.personalStreetAddress()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_PERSONAL")+": "+this.personalStreetAddress(),value:Enums.ContactsPrimaryAddress.Personal}),""!==this.businessStreetAddress()&&t.push({text:c.i18n("CONTACTSWEBCLIENT/LABEL_BUSINESS")+": "+this.businessStreetAddress(),value:Enums.ContactsPrimaryAddress.Business}),t},this),this.hasEmails=r.computed(function(){return 0<this.emails().length},this),this.allowSendThisContact=r.computed(function(){return""!==b.SaveVcfServerModuleName},this),this.extented.subscribe(function(t){t&&(this.personalCollapsed(!this.personalIsEmpty()),this.businessCollapsed(!this.businessIsEmpty()),this.otherCollapsed(!this.otherIsEmpty()),this.groupsCollapsed(!this.groupsIsEmpty()))},this),this.birthMonthSelect=i.birthMonthSelect,this.birthDaySelect=r.computed(function(){for(var t=1,e=h.daysInMonth(this.otherBirthMonth(),this.otherBirthYear()),s=[{text:c.i18n("COREWEBCLIENT/LABEL_DAY"),value:0}];t<=e;t++)s.push({text:t.toString(),value:t});return s},this),this.birthYearSelect=[{text:c.i18n("CONTACTSWEBCLIENT/LABEL_YEAR"),value:0}];for(var t=(new Date).getFullYear(),e=t,s=t-100;e>=s;e--)this.birthYearSelect.push({text:e.toString(),value:e});this.canBeSave=r.computed(function(){return""!==this.displayName()||!!this.emails().length},this)}var o=s("F/us"),n=s("EVdn"),r=s("0h2I"),a=s("wd/R"),l=s("Ol7c"),h=s("nKlx"),c=s("RN+F"),u=s("AFLV"),p=s("tYdA"),d=s("JFZZ"),m=s("IAk5"),f=s("5hOJ"),b=s("+JH/");i.aBirthdayMonths=h.getMonthNamesArray(),i.birthMonthSelect=[{text:c.i18n("COREWEBCLIENT/LABEL_MONTH"),value:0},{text:i.aBirthdayMonths[0],value:1},{text:i.aBirthdayMonths[1],value:2},{text:i.aBirthdayMonths[2],value:3},{text:i.aBirthdayMonths[3],value:4},{text:i.aBirthdayMonths[4],value:5},{text:i.aBirthdayMonths[5],value:6},{text:i.aBirthdayMonths[6],value:7},{text:i.aBirthdayMonths[7],value:8},{text:i.aBirthdayMonths[8],value:9},{text:i.aBirthdayMonths[9],value:10},{text:i.aBirthdayMonths[10],value:11},{text:i.aBirthdayMonths[11],value:12}],i.prototype.clear=function(){this.isNew(!1),this.readOnly(!1),this.uuid(""),this.idUser(""),this.team(!1),this.storage(""),this.itsMe(!1),this.edited(!1),this.extented(!1),this.personalCollapsed(!1),this.businessCollapsed(!1),this.otherCollapsed(!1),this.groupsCollapsed(!1),this.displayName(""),this.firstName(""),this.lastName(""),this.nickName(""),this.skype(""),this.facebook(""),this.primaryEmail(this.sEmailDefaultType),this.primaryPhone(this.sPhoneDefaultType),this.primaryAddress(this.sAddressDefaultType),this.personalEmail(""),this.personalStreetAddress(""),this.personalCity(""),this.personalState(""),this.personalZipCode(""),this.personalCountry(""),this.personalWeb(""),this.personalFax(""),this.personalPhone(""),this.personalMobile(""),this.businessEmail(""),this.businessCompany(""),this.businessDepartment(""),this.businessJob(""),this.businessOffice(""),this.businessStreetAddress(""),this.businessCity(""),this.businessState(""),this.businessZipCode(""),this.businessCountry(""),this.businessWeb(""),this.businessFax(""),this.businessPhone(""),this.otherEmail(""),this.otherBirthMonth(0),this.otherBirthDay(0),this.otherBirthYear(0),this.otherNotes(""),this.etag(""),this.sharedToAll(!1),this.groups([])},i.prototype.switchToNew=function(){this.clear(),this.edited(!0),this.extented(!1),this.isNew(!0),m.isMobile()||this.displayNameFocused(!0)},i.prototype.switchToView=function(){this.edited(!1),this.extented(!1)},i.prototype.toObject=function(){return{UUID:this.uuid(),PrimaryEmail:this.primaryEmail(),PrimaryPhone:this.primaryPhone(),PrimaryAddress:this.primaryAddress(),FullName:this.displayName(),FirstName:this.firstName(),LastName:this.lastName(),NickName:this.nickName(),Storage:this.storage(),Skype:this.skype(),Facebook:this.facebook(),PersonalEmail:this.personalEmail(),PersonalAddress:this.personalStreetAddress(),PersonalCity:this.personalCity(),PersonalState:this.personalState(),PersonalZip:this.personalZipCode(),PersonalCountry:this.personalCountry(),PersonalWeb:this.personalWeb(),PersonalFax:this.personalFax(),PersonalPhone:this.personalPhone(),PersonalMobile:this.personalMobile(),BusinessEmail:this.businessEmail(),BusinessCompany:this.businessCompany(),BusinessJobTitle:this.businessJob(),BusinessDepartment:this.businessDepartment(),BusinessOffice:this.businessOffice(),BusinessAddress:this.businessStreetAddress(),BusinessCity:this.businessCity(),BusinessState:this.businessState(),BusinessZip:this.businessZipCode(),BusinessCountry:this.businessCountry(),BusinessFax:this.businessFax(),BusinessPhone:this.businessPhone(),BusinessWeb:this.businessWeb(),OtherEmail:this.otherEmail(),Notes:this.otherNotes(),ETag:this.etag(),BirthDay:this.otherBirthDay(),BirthMonth:this.otherBirthMonth(),BirthYear:this.otherBirthYear(),GroupUUIDs:this.groups()}},i.prototype.parse=function(t){this.uuid(u.pString(t.UUID)),this.idUser(u.pString(t.IdUser)),this.team("team"===t.Storage),this.storage(u.pString(t.Storage)),this.itsMe(!!t.ItsMe),this.readOnly(!!t.ReadOnly),this.displayName(u.pString(t.FullName)),this.firstName(u.pString(t.FirstName)),this.lastName(u.pString(t.LastName)),this.nickName(u.pString(t.NickName)),this.skype(u.pString(t.Skype)),this.facebook(u.pString(t.Facebook)),this.primaryEmail(u.pInt(t.PrimaryEmail)),this.primaryPhone(u.pInt(t.PrimaryPhone)),this.primaryAddress(u.pInt(t.PrimaryAddress)),this.personalEmail(u.pString(t.PersonalEmail)),this.personalStreetAddress(u.pString(t.PersonalAddress)),this.personalCity(u.pString(t.PersonalCity)),this.personalState(u.pString(t.PersonalState)),this.personalZipCode(u.pString(t.PersonalZip)),this.personalCountry(u.pString(t.PersonalCountry)),this.personalWeb(u.pString(t.PersonalWeb)),this.personalFax(u.pString(t.PersonalFax)),this.personalPhone(u.pString(t.PersonalPhone)),this.personalMobile(u.pString(t.PersonalMobile)),this.businessEmail(u.pString(t.BusinessEmail)),this.businessCompany(u.pString(t.BusinessCompany)),this.businessDepartment(u.pString(t.BusinessDepartment)),this.businessJob(u.pString(t.BusinessJobTitle)),this.businessOffice(u.pString(t.BusinessOffice)),this.businessStreetAddress(u.pString(t.BusinessAddress)),this.businessCity(u.pString(t.BusinessCity)),this.businessState(u.pString(t.BusinessState)),this.businessZipCode(u.pString(t.BusinessZip)),this.businessCountry(u.pString(t.BusinessCountry)),this.businessWeb(u.pString(t.BusinessWeb)),this.businessFax(u.pString(t.BusinessFax)),this.businessPhone(u.pString(t.BusinessPhone)),this.otherEmail(u.pString(t.OtherEmail)),this.otherBirthMonth(u.pInt(t.BirthMonth)),this.otherBirthDay(u.pInt(t.BirthDay)),this.otherBirthYear(u.pInt(t.BirthYear)),this.otherNotes(u.pString(t.Notes)),this.etag(u.pString(t.ETag)),this.sharedToAll("shared"===t.Storage),o.isArray(t.GroupUUIDs)&&this.groups(t.GroupUUIDs)},i.prototype.getFullEmail=function(t){return u.isNonEmptyString(t)||(t=this.email()),l.getFullEmail(this.displayName(),t)},i.prototype.getEmailsString=function(){return o.uniq(o.without([this.email(),this.personalEmail(),this.businessEmail(),this.otherEmail()],"")).join(",")},i.prototype.sendThisContact=function(){var t=s("OgeD").run("MailWebclient","getComposeMessageWithAttachments"),e={UUID:this.uuid(),FileName:"contact-"+this.getFullEmail().replace('"',"").replace("<","").replace(">","")+".vcf"};p.send("SaveContactAsTempFile",e,function(e){e.Result?o.isFunction(t)&&t([e.Result]):d.showErrorByCode(e,c.i18n("CONTACTSWEBCLIENT/ERROR_CONTACT_AS_TEMPFAILE"))},this)},i.prototype.isStrLink=function(t){return/^http/.test(t)},t.exports=i},"uN/E":function(t,e,s){var i,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgentData))){var e=function(){return t.URL||t.webkitURL||t},s=t.document.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in s,o=/constructor/i.test(t.HTMLElement)||t.safari,n=/CriOS\/[\d]+/.test(navigator.userAgentData),r=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},a=function(t){setTimeout(function(){"string"==typeof t?e().revokeObjectURL(t):t.remove()},4e4)},l=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},h=function(h,c,u){u||(h=l(h));var p,d=this,m="application/octet-stream"===h.type,f=function(){!function(t,e,s){for(var i=(e=[].concat(e)).length;i--;){var o=t["on"+e[i]];if("function"==typeof o)try{o.call(t,s||t)}catch(t){r(t)}}}(d,"writestart progress write writeend".split(" "))};if(d.readyState=d.INIT,i)return p=e().createObjectURL(h),void setTimeout(function(){s.href=p,s.download=c,function(t){var e=new MouseEvent("click");t.dispatchEvent(e)}(s),f(),a(p),d.readyState=d.DONE});!function(){if((n||m&&o)&&t.FileReader){var s=new FileReader;return s.onloadend=function(){var e=n?s.result:s.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,d.readyState=d.DONE,f()},s.readAsDataURL(h),void(d.readyState=d.INIT)}p||(p=e().createObjectURL(h)),m?t.location.href=p:t.open(p,"_blank")||(t.location.href=p);d.readyState=d.DONE,f(),a(p)}()},c=h.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,s){return e=e||t.name||"download",s||(t=l(t)),navigator.msSaveOrOpenBlob(t,e)}:(c.abort=function(){},c.readyState=c.INIT=0,c.WRITING=1,c.DONE=2,c.error=c.onwritestart=c.onprogress=c.onwrite=c.onabort=c.onerror=c.onwriteend=null,function(t,e,s){return new h(t,e||t.name||"download",s)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);t.exports?t.exports.saveAs=o:null!==s("B9Yq")&&null!==s("PDX0")&&(void 0===(i=function(){return o}.call(e,s,e,t))||(t.exports=i))},v6sP:function(t,e,s){"use strict";function i(){this.oContacts={},this.oResponseHandlers={},this.aRequestedEmails=[],this.aVcardAttachments=[],this.oNewContactParams=null}var o=s("EVdn"),n=s("F/us"),r=s("tYdA"),a=s("tgQO");i.prototype.clearInfoAboutEmail=function(t){this.oContacts[t]=void 0},i.prototype.getContactsByEmails=function(t,e){var s=[],i=[],a=Math.random().toString();n.each(t,n.bind(function(t){var e=this.oContacts[t];void 0!==e?s[t]=e:-1===n.indexOf(this.aRequestedEmails,t)&&i.push(t)},this)),o.isFunction(e)&&e(s),i.length>0&&(this.oResponseHandlers[a]=e,this.aRequestedEmails=n.union(this.aRequestedEmails,i),r.send("GetContactsByEmails",{Storage:"all",Emails:i,HandlerId:a},this.onGetContactsByEmailsResponse,this))},i.prototype.onGetContactsByEmailsResponse=function(t,e){var s=e.Parameters,i=this.oResponseHandlers[s.HandlerId],r=t.Result,l=s.Emails,h={};r&&n.each(r,n.bind(function(t){var e=new a;e&&(e.parse(t),this.oContacts[e.email()]=e)},this)),this.aRequestedEmails=n.difference(this.aRequestedEmails,l),n.each(l,n.bind(function(t){this.oContacts[t]||(this.oContacts[t]=null),h[t]=this.oContacts[t]},this)),o.isFunction(i)&&i(h),delete this.oResponseHandlers[s.HandlerId]},i.prototype.addVcard=function(t){this.aVcardAttachments.push(t)},i.prototype.getVcard=function(t){return n.find(this.aVcardAttachments,function(e){return e.file()===t})},i.prototype.markVcardsExistentByFile=function(t){n.each(this.aVcardAttachments,function(e){e.file()===t&&e.exists(!0)})},i.prototype.markVcardsNonexistentByUid=function(t){n.each(this.aVcardAttachments,function(e){-1!==n.indexOf(t,e.uid())&&e.exists(!1)})},i.prototype.saveNewContactParams=function(t){this.oNewContactParams=t},i.prototype.getNewContactParams=function(){var t=this.oNewContactParams;return this.oNewContactParams=null,t},t.exports=new i},vLmA:function(t,e,s){"use strict";function i(){a.call(this,l.ServerModuleName),this.contactsPerPageValues=n.observableArray(r.getAdaptedPerPageList(l.ContactsPerPage)),this.contactsPerPage=n.observable(l.ContactsPerPage)}var o=s("F/us"),n=s("0h2I"),r=s("AFLV"),a=s("OgeD").run("SettingsWebclient","getAbstractSettingsFormViewClass"),l=s("+JH/");o.extendOwn(i.prototype,a.prototype),i.prototype.ViewTemplate="ContactsWebclient_ContactsSettingsFormView",i.prototype.getCurrentValues=function(){return[this.contactsPerPage()]},i.prototype.revertTeamValues=function(){this.contactsPerPage(l.ContactsPerPage)},i.prototype.getParametersForSave=function(){return{ContactsPerPage:this.contactsPerPage()}},i.prototype.applySavedValues=function(t){l.update(t.ContactsPerPage)},t.exports=new i},"w+bY":function(t,e,s){var i;!function(){function o(t){function e(){for(;o=h<l.length&&t>c;){var i=h++,n=l[i],a=r.call(n,1);a.push(function(t){return function(i,n){--c,null==p&&(null!=i?(p=i,h=u=NaN,s()):(l[t]=n,--u?o||e():s()))}}(i)),++c,n[0].apply(null,a)}}function s(){null!=p?d(p):a?d(p,l):d.apply(null,[p].concat(l))}var i,o,a,l=[],h=0,c=0,u=0,p=null,d=n;return t||(t=1/0),i={defer:function(){return p||(l.push(arguments),++u,e()),i},await:function(t){return d=t,a=!1,u||s(),i},awaitAll:function(t){return d=t,a=!0,u||s(),i}}}function n(){}var r=[].slice;o.version="1.0.7",void 0===(i=function(){return o}.call(e,s,e,t))||(t.exports=i)}()},wSTV:function(t,e,s){"use strict";function i(){y.call(this,"ContactsWebclient"),this.browserTitle=r.observable(l.i18n("CONTACTSWEBCLIENT/HEADING_BROWSER_TAB")),this.contactCount=r.observable(0),this.uploaderArea=r.observable(null),this.dragActive=r.observable(!1),this.bDragActiveComp=r.computed(function(){return this.dragActive()},this),this.sImportContactsLink=T.ImportContactsLink,this.loadingList=r.observable(!1),this.preLoadingList=r.observable(!1),this.loadingList.subscribe(function(t){this.preLoadingList(t)},this),this.loadingViewPane=r.observable(!1),this.showPersonalContacts=r.observable(!1),this.showTeamContacts=r.observable(!1),this.showSharedToAllContacts=r.observable(!1),this.showAllContacts=r.computed(function(){return 1<[this.showPersonalContacts()?"1":"",this.showTeamContacts()?"1":"",this.showSharedToAllContacts()?"1":""].join("").length},this),this.recivedAnimPersonal=r.observable(!1).extend({autoResetToFalse:500}),this.recivedAnimShared=r.observable(!1).extend({autoResetToFalse:500}),this.recivedAnimTeam=r.observable(!1).extend({autoResetToFalse:500}),this.isTeamStorageSelected=r.observable(!1),this.isNotTeamStorageSelected=r.observable(!1),this.disableDropToPersonal=r.observable(!1),this.selectedStorageValue=r.observable(""),this.selectedStorage=r.computed({read:function(){return this.selectedStorageValue()},write:function(t){""!==t&&(this.selectedStorageValue(-1!==n.inArray(t,T.Storages)?t:T.DefaultStorage),"group"!==this.selectedStorageValue()&&(this.selectedGroupInList(null),this.selectedItem(null),this.selector.listCheckedOrSelected(!1),this.currentGroupUUID("")),this.isTeamStorageSelected("team"===this.selectedStorageValue()),this.isNotTeamStorageSelected("team"!==this.selectedStorageValue()),this.disableDropToPersonal("shared"!==this.selectedStorageValue()))},owner:this}),this.selectedGroupInList=r.observable(null),this.selectedGroupInList.subscribe(function(){var t=this.selectedGroupInList();t&&t.selected(!1)},this,"beforeChange"),this.selectedGroupInList.subscribe(function(t){t&&this.showPersonalContacts()&&(t.selected(!0),this.selectedStorage("group"),this.requestContactList())},this),this.selectedGroup=r.observable(null),this.selectedContact=r.observable(null),this.selectedGroupEmails=r.observableArray([]),this.currentGroupUUID=r.observable(""),this.oContactModel=new I,this.oGroupModel=new D,this.oImportView=new U(this),this.selectedOldItem=r.observable(null),this.selectedItem=r.computed({read:function(){return this.selectedContact()||this.selectedGroup()||null},write:function(t){t instanceof I?(this.selectedGroup(null),this.selectedContact(t)):t instanceof D?(this.selectedContact(null),this.selectedGroup(t),this.currentGroupUUID(t.uuid())):(this.selectedGroup(null),this.selectedContact(null)),this.loadingViewPane(!1)},owner:this}),this.collection=r.observableArray([]),this.contactUidForRequest=r.observable(""),this.collection.subscribe(function(){this.collection().length>0&&""!==this.contactUidForRequest()&&(this.requestContact(this.contactUidForRequest()),this.contactUidForRequest(""))},this),this.isSearchFocused=r.observable(!1),this.searchInput=r.observable(""),this.search=r.observable(""),this.groupUidForRequest=r.observable(""),this.groupFullCollection=r.observableArray([]),this.groupFullCollection.subscribe(function(){this.groupUidForRequest()&&this.onViewGroupClick(this.groupUidForRequest())},this),this.selectedContact.subscribe(function(t){if(t){var e=t.groups();o.each(this.groupFullCollection(),function(t){t.checked(t&&0<=n.inArray(t.UUID(),e))})}},this),this.pageSwitcherLocked=r.observable(!1),this.oPageSwitcher=new g(0,T.ContactsPerPage),this.oPageSwitcher.currentPage.subscribe(function(){this.pageSwitcherLocked()||this.changeRouting()},this),this.currentPage=r.observable(1),this.search.subscribe(function(t){this.searchInput(t)},this),this.searchSubmitCommand=c.createCommand(this,function(){this.changeRouting({Search:this.searchInput()})}),this.searchMessagesInInbox=f.run("MailWebclient","getSearchMessagesInInbox"),this.bAllowSearchMessagesInInbox=o.isFunction(this.searchMessagesInInbox),this.composeMessageToAddresses=f.run("MailWebclient","getComposeMessageToAddresses"),this.bAllowComposeMessageToAddresses=o.isFunction(this.composeMessageToAddresses),this.selector=new m(this.collection,o.bind(this.viewContact,this),o.bind(this.deleteContact,this),this.bAllowComposeMessageToAddresses?o.bind(this.composeMessageToContact,this):null),this.checkAll=this.selector.koCheckAll(),this.checkAllIncomplite=this.selector.koCheckAllIncomplete(),this.isCheckedOrSelected=r.computed(function(){return 0<this.selector.listCheckedOrSelected().length},this),this.isEnableAddContacts=this.isCheckedOrSelected,this.isEnableRemoveContactsFromGroup=this.isCheckedOrSelected,this.isEnableDeleting=this.isCheckedOrSelected,this.isEnableSharing=this.isCheckedOrSelected,this.visibleShareCommand=r.computed(function(){return this.showPersonalContacts()&&this.showSharedToAllContacts()&&"personal"===this.selectedStorage()},this),this.visibleUnshareCommand=r.computed(function(){return this.showPersonalContacts()&&this.showSharedToAllContacts()&&"shared"===this.selectedStorage()},this),this.isExactlyOneContactSelected=r.computed(function(){return 1===this.selector.listCheckedOrSelected().length},this),this.isSaving=r.observable(!1),this.newContactCommand=c.createCommand(this,this.executeNewContact,this.isNotTeamStorageSelected),this.newGroupCommand=c.createCommand(this,this.executeNewGroup),this.addContactsCommand=c.createCommand(this,function(){},this.isEnableAddContacts),this.deleteCommand=c.createCommand(this,this.deleteContact,this.isEnableDeleting),this.selectedCount=r.computed(function(){return o.filter(this.selector.listCheckedOrSelected(),function(t){return!t.ReadOnly()}).length},this),this.shareCommand=c.createCommand(this,this.executeShare,this.isEnableSharing),this.removeFromGroupCommand=c.createCommand(this,this.executeRemoveFromGroup,this.isEnableRemoveContactsFromGroup),this.importCommand=c.createCommand(this,this.executeImport),this.saveCommand=c.createCommand(this,this.executeSave),this.updateSharedToAllCommand=c.createCommand(this,this.executeUpdateSharedToAll,this.isExactlyOneContactSelected),this.composeMessageCommand=c.createCommand(this,this.composeMessage,this.isCheckedOrSelected),this.selector.listCheckedOrSelected.subscribe(function(t){this.oGroupModel.newContactsInGroupCount(t.length)},this),this.isSearch=r.computed(function(){return""!==this.search()},this),this.isEmptyList=r.computed(function(){return 0===this.collection().length},this),this.searchText=r.computed(function(){return l.i18n("CONTACTSWEBCLIENT/INFO_SEARCH_RESULT",{SEARCH:this.search()})},this),this.visibleDragNDropToGroupText=r.computed(function(){return!p.isMobile()&&"group"===this.selectedStorage()},this),this.selectedPanel=r.observable(N.MobilePanel.Items),this.enableExport=r.computed(function(){return this.contactCount()>0},this),this.aExportData=[],o.each(T.ImportExportFormats,function(t){h.isNonEmptyString(t)&&this.aExportData.push({css:t.toLowerCase(),text:l.i18n("CONTACTSWEBCLIENT/ACTION_EXPORT_AS",{FORMAT:t.toUpperCase()}),command:c.createCommand(this,function(){this.executeExport(t)},this.enableExport)})},this),this.isPersonalStorageSelected=r.computed(function(){return"personal"===this.selectedStorage()},this),this.visibleImportExport=r.computed(function(){return this.aExportData.length>0},this),this.infoCreateOrImport=this.getCreateOrImportInfo(),this.listChanged=r.computed(function(){return[this.selectedStorage(),this.currentGroupUUID(),this.search(),this.oPageSwitcher.currentPage(),this.oPageSwitcher.perPage()]},this),this.bRefreshContactList=!1,p.broadcastEvent("ContactsWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}var o=s("F/us"),n=s("EVdn"),r=s("0h2I"),a=s("uN/E"),l=s("RN+F"),h=s("AFLV"),c=s("Yjhd"),u=s("JFZZ"),p=s("IAk5"),d=s("mjrp"),m=s("kwPS"),f=s("OgeD"),b=s("QaF5"),C=s("SQrT"),y=s("xcwT"),g=s("fIp0"),E=s("76Kh"),S=s("20Ah"),v=s("/tOA"),A=s("tYdA"),P=s("v6sP"),T=s("+JH/"),w=s("Is5a"),I=s("tgQO"),D=s("Mqix"),U=s("YAzK"),N=window.Enums;o.extendOwn(i.prototype,y.prototype),i.prototype.ViewTemplate="ContactsWebclient_ContactsScreenView",i.prototype.ViewConstructorName="CContactsView",i.prototype.getFormatDependentText=function(t){switch(T.ImportExportFormats.length){case 0:return"";case 1:return l.i18n("CONTACTSWEBCLIENT/"+t+"_SINGLE_EXT",{EXTENSION:T.ImportExportFormats[0].toUpperCase()});default:return l.i18n("CONTACTSWEBCLIENT/"+t+"_PLURAL_EXT",{EXTENSIONS:o.initial(T.ImportExportFormats).join(", ").toUpperCase(),LASTEXTENSION:o.last(T.ImportExportFormats).toUpperCase()})}},i.prototype.getCreateOrImportInfo=function(){var t=this.getFormatDependentText("INFO_OR_IMPORT");return l.i18n("CONTACTSWEBCLIENT/INFO_CREATE")+(""===t?"":" "+t)+"."},i.prototype.executeSave=function(t){var e,s={},i=[];if(t===this.selectedItem()&&this.selectedItem().canBeSave()){if(t instanceof I&&!t.readOnly())o.each(this.groupFullCollection(),function(t){t&&t.checked()&&i.push(t.UUID())}),t.groups(i),this.selectedItem()&&P.clearInfoAboutEmail(this.selectedItem().email()),s=t.toObject(),"personal"!==this.selectedStorage()&&"personal"===s.Storage&&this.recivedAnimPersonal(!0),"team"!==this.selectedStorage()&&"team"===s.Storage&&this.recivedAnimTeam(!0),t.isNew()?("all"===this.selectedStorage()||"group"===this.selectedStorage()?s.Storage="personal":s.Storage=this.selectedStorage(),this.isSaving(!0),A.send("CreateContact",{Contact:s},this.onCreateContactResponse,this)):(this.isSaving(!0),A.send("UpdateContact",{Contact:s},this.onUpdateContactResponse,this));else if(t instanceof D&&!t.readOnly()){var n=o.map(this.selector.listCheckedOrSelected(),function(t){return t.UUID()});this.isSaving(!0),e=t.toObject(n),t.isNew()||(e.Contacts=null),A.send(t.isNew()?"CreateGroup":"UpdateGroup",{Group:e},this.onCreateGroupResponse,this)}}else C.showError(l.i18n("CONTACTSWEBCLIENT/ERROR_EMAIL_OR_NAME_BLANK"))},i.prototype.onCreateContactResponse=function(t,e){this.isSaving(!1),t.Result?(this.requestContactList(),this.viewContact(t.Result.UUID),C.showReport(l.i18n("CONTACTSWEBCLIENT/REPORT_CONTACT_SUCCESSFULLY_ADDED"))):u.showErrorByCode(t,l.i18n("CONTACTSWEBCLIENT/ERROR_CREATE_CONTACT"))},i.prototype.onUpdateContactResponse=function(t,e){this.isSaving(!1),t.Result?(this.selectedContact()&&this.selectedContact().edited()&&this.selectedContact().edited(!1),this.requestContactList(),C.showReport(l.i18n("CONTACTSWEBCLIENT/REPORT_CONTACT_SUCCESSFULLY_UPDATED"))):u.showErrorByCode(t,l.i18n("CONTACTSWEBCLIENT/ERROR_UPDATE_CONTACT"))},i.prototype.changeRouting=function(t,e){var s=void 0===(t=t||{}).Storage?this.selectedStorage():t.Storage,i=void 0===t.GroupUUID?this.currentGroupUUID():t.GroupUUID,o=void 0===t.Search?this.search():t.Search,n=void 0===t.Page?this.oPageSwitcher.currentPage():t.Page,r=void 0===t.ContactUUID?"":t.ContactUUID,a=void 0===t.Action?"":t.Action;e?b.replaceHash(v.getContacts(s,i,o,n,r,a)):b.setHash(v.getContacts(s,i,o,n,r,a))},i.prototype.executeNewContact=function(){if(this.showPersonalContacts()){var t="group"===this.selectedStorage()?this.currentGroupUUID():"";this.changeRouting({GroupUUID:t,Action:"create-contact"})}},i.prototype.executeNewGroup=function(){var t="group"===this.selectedStorage()?this.currentGroupUUID():"";this.selector.itemSelected()instanceof w&&this.selector.itemSelected().checked(!0),this.changeRouting({GroupUUID:t,Action:"create-group"})},i.prototype.deleteContact=function(){var t=this.selectedStorage();if("personal"===t||"shared"===t){var e=o.filter(this.selector.listCheckedOrSelected(),function(t){return!t.ReadOnly()}),s=e.length,i=l.i18n("CONTACTSWEBCLIENT/CONFIRM_DELETE_CONTACTS_PLURAL",{},null,s),n=o.bind(function(t){t&&this.deleteContacts(e)},this);E.showPopup(S,[i,n,"",l.i18n("COREWEBCLIENT/ACTION_DELETE")])}else"group"===t&&this.removeFromGroupCommand()},i.prototype.deleteContacts=function(t){var e=this,s=this.selectedContact(),i=o.map(t,function(t){return t.UUID()});0<i.length&&(this.preLoadingList(!0),o.each(t,function(t){t&&(P.clearInfoAboutEmail(t.Email()),!s||t.IsGroup()||t.ReadOnly()||s.readOnly()||s.uuid()!==t.UUID()||(s=null,this.selectedContact(null)))},this),o.each(this.collection(),function(e){-1<n.inArray(e,t)&&e.deleted(!0)}),o.delay(function(){e.collection.remove(function(t){return t.deleted()})},500),A.send("DeleteContacts",{Storage:this.selectedStorage(),UUIDs:i},function(t){t.Result||u.showErrorByCode(t,l.i18n("CONTACTSWEBCLIENT/ERROR_DELETE_CONTACTS")),this.requestContactList()},this),P.markVcardsNonexistentByUid(i))},i.prototype.executeRemoveFromGroup=function(){var t=this,e=this.selectedGroupInList(),s=this.selector.listCheckedOrSelected(),i=o.map(s,function(t){return t.UUID()});i=o.compact(i),e&&0<i.length&&(this.preLoadingList(!0),o.each(this.collection(),function(t){-1<n.inArray(t,s)&&t.deleted(!0)}),o.delay(function(){t.collection.remove(function(t){return t.deleted()})},500),A.send("RemoveContactsFromGroup",{GroupUUID:e.UUID(),ContactUUIDs:i},function(t){t.Result||u.showErrorByCode(t),this.requestContactList()},this))},i.prototype.executeImport=function(){this.changeRouting({Storage:"personal",GroupUUID:"",Search:"",Page:1,Action:"import"})},i.prototype.executeExport=function(t){var e=o.map(this.selector.listCheckedOrSelected(),function(t){return t.sUUID}),s=this.selectedStorage();"group"===s&&(s="all"),A.send("Export",{Format:t,Storage:s,GroupUUID:this.currentGroupUUID(),ContactUUIDs:e},function(e){var s=new Blob([e.ResponseText],{type:"text/plain;charset=utf-8"});a.saveAs(s,"export."+t,!0)},this,{Format:"Raw"})},i.prototype.executeCancel=function(){var t=this.selectedItem();t&&(t instanceof I&&!t.readOnly()?t.isNew()?b.setPreviousHash():t.edited()?(t.edited(!1),this.requestContact(t.uuid())):this.changeRouting():t instanceof D&&!t.readOnly()?t.isNew()?b.setPreviousHash():t.edited()?(this.selectedItem(this.selectedOldItem()),t.edited(!1)):this.changeRouting():this.oImportView.visibility()&&b.setPreviousHash())},i.prototype.executeAddContactsToGroup=function(t,e){t&&o.isArray(e)&&0<e.length&&(t.recivedAnim(!0),this.executeAddContactsToGroupUUID(t.UUID(),e))},i.prototype.executeAddContactsToGroupUUID=function(t,e){t&&o.isArray(e)&&0<e.length&&A.send("AddContactsToGroup",{GroupUUID:t,ContactUUIDs:e},this.onAddContactsToGroupResponse,this)},i.prototype.onAddContactsToGroupResponse=function(t){t.Result||u.showErrorByCode(t),this.requestContactList(),this.selector.itemSelected()&&this.requestContact(this.selector.itemSelected().UUID())},i.prototype.executeAddSelectedContactsToGroup=function(t){var e=this.selector.listCheckedOrSelected(),s=[];t&&o.isArray(e)&&0<e.length&&o.each(e,function(t){t&&!t.IsGroup()&&s.push(t.UUID())},this),this.executeAddContactsToGroup(t,s)},i.prototype.groupsInContactView=function(t){var e=[],s=[];return t&&!t.groupsIsEmpty()&&(s=t.groups(),e=o.filter(this.groupFullCollection(),function(t){return 0<=n.inArray(t.UUID(),s)})),e},i.prototype.onShow=function(){this.selector.useKeyboardKeys(!0),this.oPageSwitcher.show(),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!0),this.bRefreshContactList=!0},i.prototype.onHide=function(){this.selector.listCheckedOrSelected(!1),this.selector.useKeyboardKeys(!1),this.selectedItem(null),this.oPageSwitcher.hide(),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!1)},i.prototype.onBind=function(){this.selector.initOnApplyBindings(".contact_sub_list .item",".contact_sub_list .selected.item",".contact_sub_list .item .custom_checkbox",n(".contact_list",this.$viewDom),n(".contact_list_scroll.scroll-inner",this.$viewDom));var t=this;this.$viewDom.on("click",".content .item.add_to .dropdown_helper .item",function(){n(this).hasClass("new-group")?t.executeNewGroup():t.executeAddSelectedContactsToGroup(r.dataFor(this))}),this.showPersonalContacts(-1!==n.inArray("personal",T.Storages)),this.showTeamContacts(-1!==n.inArray("team",T.Storages)),this.showSharedToAllContacts(-1!==n.inArray("shared",T.Storages)),this.selectedStorage(this.selectedStorage()),this.oImportView.onBind(),this.requestGroupFullList(),p.isMobile()||this.hotKeysBind(),this.initUploader()},i.prototype.hotKeysBind=function(){var t=!1;n(document).on("keydown",o.bind(function(e){var s=e.keyCode,i=this.collection()[0],o=this.isSearchFocused(),n=!1;this.shown()&&!c.isTextFieldFocused()&&!o&&e&&s===N.Key.s?(e.preventDefault(),this.searchFocus()):i&&(n=i.selected(),i&&o&&e&&s===N.Key.Down?(this.isSearchFocused(!1),this.selector.itemSelected(i),t=!0):!o&&t&&n&&e&&s===N.Key.Up?(this.isSearchFocused(!0),this.selector.itemSelected(!1),t=!1):n?t=!0:n||(t=!1))},this))},i.prototype.refreshContactsAndGroups=function(){this.requestContactList(),this.requestGroupFullList()},i.prototype.requestContactList=function(){var t="group"===this.selectedStorage()&&this.selectedGroupInList()?this.selectedGroupInList().UUID():"",e=""!==t?"all":this.selectedStorage();this.loadingList(!0),A.send("GetContacts",{Offset:(this.currentPage()-1)*T.ContactsPerPage,Limit:T.ContactsPerPage,SortField:N.ContactSortField.Name,Search:this.search(),GroupUUID:t,Storage:e},this.onGetContactsResponse,this)},i.prototype.requestGroupFullList=function(){A.send("GetGroups",null,this.onGetGroupsResponse,this)},i.prototype.requestContact=function(t){this.loadingViewPane(!0);var e=o.find(this.collection(),function(e){return e.UUID()===t});e?(this.selector.itemSelected(e),A.send("GetContact",{UUID:e.UUID()},this.onGetContactResponse,this)):(this.contactUidForRequest(t),this.selector.itemSelected(null),this.selectedItem(null))},i.prototype.editGroup=function(t){var e=new D;e.populate(t),this.selectedOldItem(e),t.edited(!0)},i.prototype.changeGroupType=function(t){this.changeRouting({Storage:t,GroupUUID:""})},i.prototype.onViewGroupClick=function(t){var e="string"==typeof t?t:t.UUID();this.changeRouting({Storage:"group",GroupUUID:e})},i.prototype.onRoute=function(t){var e=v.parseContacts(t),s=this.selectedStorage()!==e.Storage||this.currentGroupUUID()!==e.GroupUUID||this.search()!==e.Search,i=this.bRefreshContactList;switch(this.bRefreshContactList=!1,this.pageSwitcherLocked(!0),this.oPageSwitcher.perPage()!==T.ContactsPerPage&&(i=!0),s?(this.oPageSwitcher.clear(),this.oPageSwitcher.perPage(T.ContactsPerPage)):this.oPageSwitcher.setPage(e.Page,T.ContactsPerPage),this.pageSwitcherLocked(!1),e.Page!==this.oPageSwitcher.currentPage()&&b.replaceHash(v.getContacts(e.Storage,e.GroupUUID,e.Search,this.oPageSwitcher.currentPage())),this.currentPage()!==e.Page&&(this.currentPage(e.Page),i=!0),this.selectedStorage()!==e.Storage&&-1!==n.inArray(e.Storage,T.Storages)&&"group"!==e.Storage?(this.selectedStorage(e.Storage),i=!0):"group"!==e.Storage||"create-group"===e.Action||this.currentGroupUUID()===e.GroupUUID&&""!==e.ContactUUID||(this.viewGroup(e.GroupUUID)?i=!1:b.replaceHash(v.getContacts())),this.search()!==e.Search&&(this.search(e.Search),i=!0),this.contactUidForRequest(""),e.ContactUUID?0===this.collection().length?this.contactUidForRequest(e.ContactUUID):this.requestContact(e.ContactUUID):this.selectedItem()instanceof I&&(this.selector.itemSelected(null),this.selectedItem(null)),e.Action){case"create-contact":var r=this.selectedGroupInList(),a=P.getNewContactParams();this.oContactModel.switchToNew(),this.oContactModel.groups(r?[r.UUID()]:[]),a&&(o.each(a,function(t,e){o.isFunction(this.oContactModel[e])&&this.oContactModel[e](t)},this),this.oContactModel.extented(!0)),this.selectedItem(this.oContactModel),this.selector.itemSelected(null),this.oImportView.visibility(!1);break;case"create-group":this.oGroupModel.switchToNew(),this.selectedItem(this.oGroupModel),this.selector.itemSelected(null),this.oImportView.visibility(!1);break;case"import":this.selectedItem(null),this.oImportView.visibility(!0),this.selector.itemSelected(null);break;default:e.ContactUUID||e.GroupUUID||(this.selectedItem(null),this.selector.itemSelected(null)),this.oImportView.visibility(!1)}i&&this.requestContactList(),this.isSaving(!1)},i.prototype.viewGroup=function(t){var e=o.find(this.groupFullCollection(),function(e){return e&&e.UUID()===t});return e?(this.groupUidForRequest(""),this.oGroupModel.clear(),this.oGroupModel.uuid(e.UUID()).name(e.Name()),e.IsOrganization()&&this.requestGroup(e),this.selectedGroupInList(e),this.selectedItem(this.oGroupModel),this.selector.itemSelected(null),this.selector.listCheckedOrSelected(!1)):this.groupUidForRequest(t),!!e},i.prototype.deleteGroup=function(t){t&&(this.groupFullCollection.remove(function(e){return e&&e.UUID()===t}),A.send("DeleteGroup",{UUID:t},function(t){t.Result||u.showErrorByCode(t),this.requestGroupFullList()},this),this.changeGroupType(T.DefaultStorage))},i.prototype.mailGroup=function(t){this.bAllowComposeMessageToAddresses&&t&&A.send("GetContacts",{Storage:"all",Offset:0,Limit:200,SortField:N.ContactSortField.Name,GroupUUID:t.uuid()},function(t){var e=t&&t.Result&&t.Result.List,s=(h.isNonEmptyArray(e)?o.compact(o.map(e,function(t){var e=new w;return e.parse(t),""!==e.Email()?e.getFullEmail():""})):[]).join(", ");""!==s&&this.composeMessageToAddresses(s)},this)},i.prototype.dragAndDropHelper=function(t){t&&t.checked(!0);var e=this.selector.itemSelected(),s=c.draggableItems(),i=this.selector.listCheckedOrSelected().length,r=0<i?o.map(this.selector.listCheckedOrSelected(),function(t){return t.UUID()}):[];return e&&!e.checked()&&e.checked(!0),s.data("drag-contatcs-storage",this.selectedStorage()),s.data("drag-contatcs-uids",r),n(".count-text",s).text(l.i18n("CONTACTSWEBCLIENT/LABEL_DRAG_CONTACTS_PLURAL",{COUNT:i},null,i)),s},i.prototype.contactsDrop=function(t,e,s){if(t){var i=s&&s.helper?s.helper:null,o=i?i.data("drag-contatcs-uids"):null;null!==o&&(c.uiDropHelperAnim(e,s),this.executeAddContactsToGroup(t,o))}},i.prototype.contactsDropToGroupType=function(t,e,s){var i=s&&s.helper,o=i&&i.data("drag-contatcs-storage")||null;null!==(i&&i.data("drag-contatcs-uids")||null)&&null!==o&&t!==o&&(c.uiDropHelperAnim(e,s),this.executeShare())},i.prototype.searchFocus=function(){this.selector.useKeyboardKeys()&&!c.isTextFieldFocused()&&this.isSearchFocused(!0)},i.prototype.viewContact=function(t){if(t){var e="group"===this.selectedStorage()?this.currentGroupUUID():"",s="string"==typeof t?t:t.UUID();this.changeRouting({GroupUUID:e,ContactUUID:s})}},i.prototype.composeMessageToContact=function(t){var e=t?t.getFullEmail():"";""!==e&&this.composeMessageToAddresses(e)},i.prototype.composeMessage=function(){var t=this.selector.listCheckedOrSelected(),e=(h.isNonEmptyArray(t)?o.compact(o.map(t,function(t){return""!==t.Email()?t.getFullEmail():""})):[]).join(", ");""!==e&&this.composeMessageToAddresses(e)},i.prototype.onClearSearchClick=function(){this.searchInput(""),this.searchSubmitCommand()},i.prototype.onGetContactResponse=function(t,e){var s=t.Result;if(s){var i=new I,o=this.selector.itemSelected();i.parse(s),o&&o.UUID()===i.uuid()&&(this.selectedContact()instanceof I&&i instanceof I&&this.selectedContact().uuid()===i.uuid()&&i.edited(this.selectedContact().edited()),this.selectedItem(i))}else u.showErrorByCode(t)},i.prototype.onGetContactsResponse=function(t,e){var s=t.Result;if(s){var i=h.pInt(s.ContactCount),r=h.isNonEmptyArray(s.List)?o.compact(o.map(s.List,function(t){var e=new w;return e.parse(t),e})):[],a=this.selector.itemSelected(),l=a?o.find(r,function(t){return a.UUID()===t.UUID()}):null,c=this.selector.listChecked(),p=c&&0<c.length?o.map(c,function(t){return t.UUID()}):[];h.isNonEmptyArray(p)&&o.each(r,function(t){t.checked(-1<n.inArray(t.UUID(),p))}),this.collection(r),this.oPageSwitcher.setCount(i),this.contactCount(i),l?(this.selector.itemSelected(l),this.requestContact(l.UUID())):a&&this.changeRouting({},!0),this.selectedGroupEmails(this.selectedGroup()?o.uniq(o.flatten(o.map(this.collection(),function(t){return t.aEmails}))):[])}else u.showErrorByCode(t);this.loadingList(!1)},i.prototype.viewAllMails=function(){this.selectedGroupEmails().length>0&&this.searchMessagesInInbox("email:"+this.selectedGroupEmails().join(","))},i.prototype.onGetGroupsResponse=function(t,e){var s=t.Result;if(s){var i=0,n=0,r=[],a=o.find(this.groupFullCollection(),function(t){return t.selected()}),l=null;for(this.groupFullCollection(r),this.selectedGroupInList(null),n=s.length;i<n;i++)s[i]&&(s[i].IsGroup=!0,(l=new w).parse(s[i]),l.IsGroup()&&(a&&a.UUID()===l.UUID()&&this.selectedGroupInList(l),r.push(l)));null===this.selectedGroupInList()&&b.replaceHash(v.getContacts()),this.groupFullCollection(r)}else u.showErrorByCode(t)},i.prototype.onCreateGroupResponse=function(t,e){this.isSaving(!1),t.Result?("string"==typeof t.Result&&""!==t.Result?this.onViewGroupClick(t.Result):this.selectedGroup()&&this.selectedGroup().edited()&&this.selectedGroup().edited(!1),C.showReport(l.i18n("CONTACTSWEBCLIENT/REPORT_GROUP_SUCCESSFULLY_ADDED")),this.requestGroupFullList()):u.showErrorByCode(t,l.i18n("CONTACTSWEBCLIENT/ERROR_SAVE_GROUP"))},i.prototype.executeShare=function(){var t="all"===this.selectedStorage(),e=o.filter(this.selector.listCheckedOrSelected(),function(t){return"team"!==t.sStorage}),s=o.map(e,function(t){return t.UUID()});0<(s=o.compact(s)).length&&(o.each(e,function(t){t&&P.clearInfoAboutEmail(t.Email())},this),t||(-1<n.inArray(this.selectedContact(),e)&&this.selectedContact(null),o.each(this.collection(),function(t){-1<n.inArray(t,e)&&t.deleted(!0)}),o.delay(function(){this.collection.remove(function(t){return t.deleted()})}.bind(this),500)),"shared"===this.selectedStorage()?this.recivedAnimPersonal(!0):this.recivedAnimShared(!0),A.send("UpdateSharedContacts",{UUIDs:s},function(){t&&(this.selector.listCheckedOrSelected(!1),this.requestContactList())},this))},i.prototype.requestGroup=function(t){this.loadingViewPane(!0),t&&A.send("GetGroup",{UUID:t.UUID()},this.onGetGroupResponse,this)},i.prototype.onGetGroupResponse=function(t,e){if(t.Result){var s=t.Result;this.oGroupModel.uuid(h.pString(s.UUID)).name(s.Name).isOrganization(s.IsOrganization).company(s.Company).country(s.Country).state(s.State).city(s.City).street(s.Street).zip(s.Zip).phone(s.Phone).fax(s.Fax).email(s.Email).web(s.Web)}else u.showErrorByCode(t)},i.prototype.onGetGroupEventsResponse=function(t,e){if(t.Result){var s=t.Result;this.oGroupModel.events(s)}},i.prototype.initUploader=function(){this.uploaderArea()&&(this.oJua=new d({action:"?/Api/",name:"jua-uploader",queueSize:2,dragAndDropElement:this.uploaderArea(),disableAjaxUpload:!1,disableFolderDragAndDrop:!1,disableDragAndDrop:!1,hidden:o.extendOwn({Module:T.ServerModuleName,Method:"Import",Parameters:o.bind(function(){return JSON.stringify({GroupUUID:this.currentGroupUUID(),Storage:"personal"})},this)},p.getCommonRequestParameters())}),this.oJua.on("onSelect",o.bind(this.onImportSelect,this)).on("onComplete",o.bind(this.onImportComplete,this)).on("onBodyDragEnter",o.bind(this.dragActive,this,!0)).on("onBodyDragLeave",o.bind(this.dragActive,this,!1)))},i.prototype.onImportSelect=function(t,e){var s=this.isNotTeamStorageSelected(),i=!1;return s&&(o.each(T.ImportExportFormats,function(t){t.toLowerCase()===e.FileName.substr(e.FileName.length-t.length).toLowerCase()&&(i=!0)}),i||(C.showError(this.getFormatDependentText("ERROR_FILE_EXTENSION")),s=!1)),s},i.prototype.onImportComplete=function(t,e,s){var i=0;!(e&&s&&s.Result)?s&&s.ErrorCode===N.Errors.IncorrectFileExtension?C.showError(this.getFormatDependentText("ERROR_FILE_EXTENSION")):C.showError(l.i18n("COREWEBCLIENT/ERROR_UPLOAD_FILE")):0<(i=h.pInt(s.Result.ImportedCount))?C.showReport(l.i18n("CONTACTSWEBCLIENT/REPORT_CONTACTS_IMPORTED_PLURAL",{NUM:i},null,i)):C.showError(l.i18n("CONTACTSWEBCLIENT/ERROR_IMPORT_NO_CONTACT")),this.requestGroupFullList(),this.requestContactList()},t.exports=i},wudd:function(t,e,s){"use strict";function i(){this.uid=n.observable(""),this.file=n.observable(""),this.name=n.observable(""),this.email=n.observable(""),this.exists=n.observable(!1),this.isJustSaved=n.observable(!1)}var o=s("F/us"),n=s("0h2I"),r=s("RN+F"),a=s("AFLV"),l=s("JFZZ"),h=s("IAk5"),c=s("tYdA"),u=s("v6sP"),p=h.isNewTab()?null:s("fG7T"),d=h.isNewTab()&&window.opener?window.opener.MainTabContactsMethods:null;i.prototype.parse=function(t){t&&"Object/Aurora\\Modules\\Mail\\Classes\\Vcard"===t["@Object"]&&(this.uid(a.pString(t.Uid)),this.file(a.pString(t.File)),this.name(a.pString(t.Name)),this.email(a.pString(t.Email)),this.exists(!!t.Exists),u.addVcard(this))},i.prototype.onContactsSaveVcfResponse=function(t,e){t.Result?this.uid(t.Result.Uid):(l.showErrorByCode(t,r.i18n("CONTACTSWEBCLIENT/ERROR_CREATE_CONTACT")),this.exists(!1))},i.prototype.addContact=function(){c.send("AddContactsFromFile",{File:this.file()},this.onContactsSaveVcfResponse,this),this.isJustSaved(!0),this.exists(!0),setTimeout(o.bind(function(){this.isJustSaved(!1)},this),2e4),p?p.recivedAnim(!0):d&&d.markVcardsExistentByFile(this.file())},t.exports=i}}]);