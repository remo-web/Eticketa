(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{QFUI:function(t,i,e){"use strict";var s=e("RN+F"),o=e("76Kh"),n=e("1grR"),r=e("hPb3"),a={};a.getDownloadLink=function(t,i,e){return i.length>0?"?/Download/"+t+"/DownloadFile/"+i+"/"+(e?"0/"+e:""):""},a.getIframeWrappwer=function(t,i){return"?/Raw/Iframe/"+t+"/"+window.encodeURIComponent(i)+"/"},a.thumbQueue=function(){var t={},i={};return function(e,s,o){s&&o?!(e in i)||i[e]>0?(e in i||(i[e]=2,t[e]=[]),i[e]--,o(s)):t[e].push({imageSrc:s,imageSrcObserver:o,messageUid:e}):t[e]&&t[e].length&&(t[e][0].imageSrcObserver(t[e][0].imageSrc),t[e].shift())}}(),a.showErrorIfAttachmentSizeLimit=function(t,i){var e=s.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE_DETAILED",{FILENAME:t,MAXSIZE:s.getFriendlySize(r.AttachmentSizeLimit)});return r.AttachmentSizeLimit>0&&i>r.AttachmentSizeLimit&&(o.showPopup(n,[e]),!0)},t.exports=a},VRPG:function(t,i,e){"use strict";t.exports=function(t){var i=e("IAk5"),s=e("cGGv");return i.isUserNormalOrTenant()?{start:function(){var i=t.OfficeDocumentViewer?t.OfficeDocumentViewer.ExtensionsToView:[];s.addViewExtensions(i)}}:null}},cGGv:function(t,i,e){"use strict";function s(){this.id=r.observable(""),this.index=r.observable(0),this.fileName=r.observable(""),this.tempName=r.observable(""),this.displayName=r.observable(""),this.extension=r.observable(""),this.fileName.subscribe(function(t){this.id(t),this.displayName(t),this.extension(p.getFileExtension(t))},this),this.size=r.observable(0),this.friendlySize=r.computed(function(){return this.size()>0?l.getFriendlySize(this.size()):""},this),this.hash=r.observable(""),this.thumbUrlInQueue=r.observable(""),this.thumbUrlInQueueSubscribtion=this.thumbUrlInQueue.subscribe(function(){this.getInThumbQueue()},this),this.thumbnailSrc=r.observable(""),this.thumbnailLoaded=r.observable(!1),this.thumbnailSessionUid=r.observable(""),this.mimeType=r.observable(""),this.uploadUid=r.observable(""),this.uploaded=r.observable(!1),this.uploadError=r.observable(!1),this.downloading=r.observable(!1),this.isViewMimeType=r.computed(function(){return-1!==n.inArray(this.mimeType(),b)},this),this.bHasHtmlEmbed=!1,this.otherTemplates=r.observableArray([]),this.visibleCancelButton=r.observable(!0),this.statusText=r.observable(""),this.statusTooltip=r.computed(function(){return this.uploadError()?this.statusText():""},this),this.progressPercent=r.observable(0),this.visibleProgress=r.observable(!1),this.uploadStarted=r.observable(!1),this.uploadStarted.subscribe(function(){this.uploadStarted()?(this.uploaded(!1),this.visibleProgress(!0),this.progressPercent(20)):(this.progressPercent(100),this.visibleProgress(!1),this.uploaded(!0))},this),this.downloading.subscribe(function(){this.downloading()?this.visibleProgress(!0):(this.visibleProgress(!1),this.progressPercent(0))},this),this.allowDrag=r.observable(!1),this.allowUpload=r.observable(!1),this.allowPublicLink=r.observable(!1),this.bIsSecure=r.observable(!1),this.isShared=r.observable(!1),this.sHeaderText="",this.oActionsData={view:{Text:l.i18n("COREWEBCLIENT/ACTION_VIEW_FILE"),Handler:o.bind(function(){this.viewFile()},this)},download:{Text:l.i18n("COREWEBCLIENT/ACTION_DOWNLOAD_FILE"),Handler:o.bind(function(){this.downloadFile()},this),Tooltip:r.computed(function(){var t=l.i18n("COREWEBCLIENT/INFO_CLICK_TO_DOWNLOAD_FILE",{FILENAME:this.fileName(),SIZE:this.friendlySize()});return""===this.friendlySize()&&(t=t.replace(" ()","")),t},this)}},this.allowActions=r.observable(!0),this.iconAction=r.observable("download"),this.cssClasses=r.computed(function(){return this.getCommonClasses().join(" ")},this),this.actions=r.observableArray([]),this.firstAction=r.computed(function(){return this.actions().length>1?this.actions()[0]:""},this),this.secondAction=r.computed(function(){return 1===this.actions().length?this.actions()[0]:this.actions().length>1?this.actions()[1]:""},this),this.subFiles=r.observableArray([]),this.subFilesExpanded=r.observable(!1)}var o=e("F/us"),n=e("EVdn"),r=e("0h2I"),a=e("IAk5"),h=e("QFUI"),l=e("RN+F"),u=e("AFLV"),c=e("ZP6a"),p=e("Yjhd"),d=e("ZCBP"),b=["image/jpeg","image/png","image/gif","text/html","text/plain","text/css","text/rfc822-headers","message/delivery-status","application/x-httpd-php","application/javascript"],m=[];n("html").hasClass("pdf")&&(b.push("application/pdf"),b.push("application/x-pdf")),s.prototype.addAction=function(t,i,e){i?this.actions.unshift(t):this.actions.push(t),this.actions(o.compact(this.actions())),e&&(this.oActionsData[t]=e)},s.prototype.removeAction=function(t){this.actions(o.without(this.actions(),t))},s.prototype.getMainAction=function(){return this.actions()[0]},s.prototype.hasAction=function(t){return-1!==o.indexOf(this.actions(),t)},s.prototype.getActionText=function(t){return this.hasAction(t)&&this.oActionsData[t]&&("string"==typeof this.oActionsData[t].Text||o.isFunction(this.oActionsData[t].Text))?o.isFunction(this.oActionsData[t].Text)?this.oActionsData[t].Text():this.oActionsData[t].Text:""},s.prototype.getActionUrl=function(t){return this.hasAction(t)&&this.oActionsData[t]?this.oActionsData[t].Url||"":""},s.prototype.executeAction=function(t){this.hasAction(t)&&this.oActionsData[t]&&o.isFunction(this.oActionsData[t].Handler)&&this.oActionsData[t].Handler()},s.prototype.getTooltip=function(t){var i=this.hasAction(t)&&this.oActionsData[t]?this.oActionsData[t].Tooltip:"";return"string"==typeof i?i:o.isFunction(i)?i():""},s.prototype.getCommonClasses=function(){var t=[];return(this.allowUpload()&&!this.uploaded()||this.downloading())&&t.push("incomplete"),this.uploadError()?t.push("fail"):t.push("success"),t},s.prototype.parse=function(t){this.fileName(u.pString(t.FileName)),this.tempName(u.pString(t.TempName)),""===this.tempName()&&this.tempName(this.fileName()),this.mimeType(u.pString(t.MimeType)),this.size(t.EstimatedSize?u.pInt(t.EstimatedSize):u.pInt(t.SizeInBytes)),this.hash(u.pString(t.Hash)),this.parseActions(t),this.uploadUid(this.hash()),this.uploaded(!0),n.isFunction(this.additionalParse)&&this.additionalParse(t)},s.prototype.parseActions=function(t){this.thumbUrlInQueue(""!==u.pString(t.ThumbnailUrl)?u.pString(t.ThumbnailUrl)+"/"+Math.random():""),this.commonParseActions(t),this.commonExcludeActions()},s.prototype.commonExcludeActions=function(){this.isViewSupported()||this.actions(o.without(this.actions(),"view"))},s.prototype.commonParseActions=function(t){o.each(t.Actions,function(t,i){this.oActionsData[i]||(this.oActionsData[i]={}),this.oActionsData[i].Url=u.pString(t.url),this.actions.push(i)},this)},s.addViewExtensions=function(t){o.isArray(t)&&(m=o.union(m,t))},s.prototype.isViewSupported=function(){return-1!==n.inArray(this.mimeType(),b)||-1!==n.inArray(this.extension(),m)},s.prototype.getInThumbQueue=function(){""===this.thumbUrlInQueue()||this.linked&&(!this.linked||this.linked())||(this.thumbnailSessionUid(Date.now().toString()),h.thumbQueue(this.thumbnailSessionUid(),this.thumbUrlInQueue(),this.thumbnailSrc))},s.prototype.downloadFile=function(){var t=this.getActionUrl("download"),i={File:this,CancelDownload:!1};t.length>0&&"#"!==t&&(a.broadcastEvent("AbstractFileModel::FileDownload::before",i),i.CancelDownload||(o.isFunction(i.CustomDownloadHandler)?i.CustomDownloadHandler():c.downloadByUrl(t)))},s.prototype.viewFile=function(t,i){p.calmEvent(i),this.viewCommonFile()},s.prototype.viewCommonFile=function(t){var i=null,e=null;u.isNonEmptyString(t)||(t=c.getAppPath()+this.getActionUrl("view")),t.length>0&&"#"!==t&&(e={sUrl:t,index:this.index(),bBreakView:!1},a.broadcastEvent("AbstractFileModel::FileView::before",e),e.bBreakView||(i=d.open(t,t,!1))&&i.focus())},s.prototype.eventDragStart=function(t,i){var e=i.originalEvent||i;return t&&e&&e.dataTransfer&&e.dataTransfer.setData&&e.dataTransfer.setData("DownloadURL",this.generateTransferDownloadUrl()),!0},s.prototype.generateTransferDownloadUrl=function(){var t=this.getActionUrl("download");return"http"!==t.substr(0,4)&&(t=c.getAppPath()+t),this.mimeType()+":"+this.fileName()+":"+t},s.prototype.onUploadSelect=function(t,i,e){e||(this.fileName(u.pString(i.FileName)),this.mimeType(u.pString(i.Type)),this.size(u.pInt(i.Size))),this.uploadUid(t),this.uploaded(!1),this.statusText(""),this.progressPercent(0),this.visibleProgress(!1)},s.prototype.onUploadStart=function(){this.visibleProgress(!0)},s.prototype.onUploadProgress=function(t,i){i>0&&(this.progressPercent(Math.ceil(t/i*100)),this.visibleProgress(!0))},s.prototype.onDownloadProgress=function(t,i){i>0&&(this.progressPercent(Math.ceil(t/i*100)),this.visibleProgress(this.progressPercent()<100))},s.prototype.onUploadComplete=function(t,i,e){var s=!(i&&e&&!e.ErrorCode&&e.Result&&!e.Result.Error),o=e&&e.ErrorCode&&e.ErrorCode===Enums.Errors.CanNotUploadFileLimit?l.i18n("COREWEBCLIENT/ERROR_UPLOAD_SIZE"):l.i18n("COREWEBCLIENT/ERROR_UPLOAD_UNKNOWN");this.progressPercent(0),this.visibleProgress(!1),this.uploaded(!0),this.uploadError(s),this.statusText(s?o:l.i18n("COREWEBCLIENT/REPORT_UPLOAD_COMPLETE")),s||(this.fillDataAfterUploadComplete(e,t),setTimeout(function(t){return function(){t.statusText("")}}(this),3e3))},s.prototype.fillDataAfterUploadComplete=function(t,i){},s.prototype.onImageLoad=function(t,i){""===this.thumbUrlInQueue()||this.thumbnailLoaded()||(this.thumbnailLoaded(!0),h.thumbQueue(this.thumbnailSessionUid()))},s.prototype.stopDownloading=function(){this.downloading(!1)},s.prototype.startDownloading=function(){this.downloading(!0)},t.exports=s}}]);